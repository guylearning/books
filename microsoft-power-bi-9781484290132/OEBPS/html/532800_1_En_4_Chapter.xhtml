<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xml:lang="en"
lang="en"
xmlns="http://www.w3.org/1999/xhtml"
xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<title>Microsoft Power BI Data Analyst Certification Companion: Preparation for Exam PL-300</title>
<link rel="stylesheet" type="text/css" href="../override_v1.css"/>
<link rel="stylesheet" type="text/css" href="../css/springer_epub.css"/>
</head>
<body>
<div id="book-content">
<div id="sbo-rt-content"><div epub:type="chapter" role="doc-chapter"><div class="ChapterContextInformation"><div class="ContextInformation" id="b978-1-4842-9013-2_4"><div class="ChapterCopyright">© The Author(s), under exclusive license to APress Media, LLC, part of Springer Nature 2023</div><span class="ContextInformationAuthorEditorNames">J. Jolly</span><span class="ContextInformationBookTitles"><span class="BookTitle">Microsoft Power BI Data Analyst Certification Companion</span></span><span class="ContextInformationSeries"><span class="SeriesTitle" lang="en">Certification Study Companion Series</span></span><span class="ChapterDOI"><a href="https://doi.org/10.1007/978-1-4842-9013-2_4">https://doi.org/10.1007/978-1-4842-9013-2_4</a></span></div></div><!--Begin Abstract--><div class="MainTitleSection"><h1 class="ChapterTitle" lang="en">4. Clean, Transform, and Load the Data</h1></div><div class="AuthorGroup"><div class="AuthorNames"><span class="Author"><span class="AuthorName">Jessica Jolly</span><sup><a href="#Aff11">1</a> <span class="ContactIcon"> </span></sup></span></div><div class="Affiliations"><div class="Affiliation" id="Aff11"><span class="AffiliationNumber">(1)</span><div class="AffiliationText">Evanston, IL, USA</div></div><div class="ClearBoth"> </div></div></div><!--End Abstract--><div class="Fulltext"><p class="Para" id="Par2">This chapter covers exam topics around cleaning data, transforming data, and loading that data into Power BI where it can be analyzed. We cover the Power Query Editor, the M language that underlies transformations, and various topics relating to data quality.</p><section class="Section1 RenderAsSection1" id="Sec1"><h2 class="Heading">Accessing the Power Query Editor</h2><p class="Para" id="Par3">After initiating the <span class="EmphasisFontCategoryNonProportional ">Get data</span> procedure within the Desktop, the Power Query Editor (PQE) will open in a new, separate window. This is intentional—the two tools are <em class="EmphasisTypeItalic ">intended</em> to work side by side. While you are active in the PQE window, you can minimize the Desktop window.</p><section class="Section2 RenderAsSection2" id="Sec2"><h3 class="Heading">What Is the Power Query Editor?</h3><p class="Para" id="Par4">Let’s set the scene. You have a project that requires you to gather data from a variety of sources. You didn’t (necessarily) originate this data, and therefore it probably needs some shaping before you can use it. It may have columns you don’t need, or it might be missing columns you do need. It may not have necessary calculations, or the data might not be in the right format for you to perform calculations on it. It might have misspellings, inconsistent abbreviations, blank rows, and null values. Any or all these things are invariably true for most data sources. Can you go back to the sources and fix them? Maybe, but most likely not. If the data comes from a database, it has been created for and is used by a lot of different people. The database owner is probably not going to change the data to meet your specific requirements. <em class="EmphasisTypeItalic ">The Power Query Editor to the rescue!</em></p><div class="Para" id="Par5">I think the Power Query Editor is the best tool <span id="ITerm1">Microsoft</span> has ever created! And you can use it through the Power BI Desktop, through Excel, or through the Power BI Service. The Power Query Editor is <em class="EmphasisTypeItalic ">not</em> a standalone application; it must be accessed through the Power BI Desktop or Service or through Excel. You can open it in one of two ways:<div class="OrderedList"><ol><li class="ListItem"><div class="ItemNumber">1)</div><div class="ItemContent"><p class="Para" id="Par6"><span class="EmphasisFontCategoryNonProportional ">Get data</span> on the <span id="ITerm2">Home tab</span></p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">2)</div><div class="ItemContent"><p class="Para" id="Par7"><span class="EmphasisFontCategoryNonProportional ">Transform data</span> on the <span id="ITerm3">Home tab</span> (as shown in Figure <span class="InternalRef"><a href="#Fig1">4-1</a></span>)</p></div><div class="ClearBoth"> </div></li></ol></div><figure class="Figure" id="Fig1"><div class="MediaObject" id="MO1"><img alt="" aria-describedby="d64e398" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig1_HTML.png" style="width:42.82em" width="1713" height="471"/><div class="TextObject" id="d64e398"><p class="Para" id="Par177">A screenshot of the pathway to access the Power Query Editor on the Power B I desktop. The following pathway, home, transform data, transform data, will open the Editor in a separate window.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-1</span><p class="SimplePara">Accessing the Power Query Editor using <span id="ITerm4">Transform data</span></p></div></figcaption></figure></div><div class="Para" id="Par8">The PQE allows you to take the <span id="ITerm5">raw data</span> (in the form of queries) and work with it to perform all the changes you need to make it work for you. What kinds of changes?<div class="OrderedList"><ol><li class="ListItem"><div class="ItemNumber">1.</div><div class="ItemContent"><p class="Para" id="Par9">Deleting, merging, combining, and splitting columns</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">2.</div><div class="ItemContent"><p class="Para" id="Par10">Deleting top, bottom, and alternate rows</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">3.</div><div class="ItemContent"><p class="Para" id="Par11">Changing the data type of a column</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">4.</div><div class="ItemContent"><p class="Para" id="Par12">Combining queries together (merging, appending)</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">5.</div><div class="ItemContent"><p class="Para" id="Par13">Duplicating or referencing a query</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">6.</div><div class="ItemContent"><p class="Para" id="Par14">Renaming and documenting columns, queries, and steps</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">7.</div><div class="ItemContent"><p class="Para" id="Par15">Replacing values, blanks, and errors</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">8.</div><div class="ItemContent"><p class="Para" id="Par16">Adding new columns</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">9.</div><div class="ItemContent"><p class="Para" id="Par17">Adding new calculations</p></div><div class="ClearBoth"> </div></li></ol></div></div><p class="Para" id="Par18">This is not a comprehensive list of all the types of changes (called transformations) you can perform, but to pass the <span id="ITerm6">PL-300 exam</span>, you should be conversant with all the preceding transformations.</p><p class="Para" id="Par19">You use the ribbon tools to specify the <span id="ITerm7">transformations</span><span id="ITerm8"></span> you want to perform for each query. Your mouse clicks are captured and recorded in individual steps, called <span class="EmphasisFontCategoryNonProportional ">Applied Steps</span>. (If you are familiar with macros in Excel, this process will sound familiar.) Each step is “translated” into M and is visible using the <span id="ITerm9"><span class="EmphasisFontCategoryNonProportional ">Formula Bar</span></span> (see Figure <span class="InternalRef"><a href="#Fig6">4-6</a></span> for an example).</p><p class="Para" id="Par20">To become a very proficient “transformer” (sorry—couldn’t help myself!), you need to be very familiar with the extensive available commands. You do <em class="EmphasisTypeItalic ">not</em> need to know how to write M from scratch, but some basic M skills are helpful on the exam (and in real life!).</p><div class="FormalPara FormalParaRenderingStyle1 ParaTypeImportant" id="FPar1"><div class="Heading">Tip</div><p class="Para FirstParaInFormalPara" id="Par21">Turn on the <span id="ITerm10"><span class="EmphasisFontCategoryNonProportional ">Formula Bar</span></span><span id="ITerm11"></span> under the <span class="EmphasisFontCategoryNonProportional ">View</span> tab. Leave it on because it is the fastest way to absorb M while going about your transformations. Each action you perform using the ribbon is recorded in M and is visible in the <span class="EmphasisFontCategoryNonProportional ">Formula Bar</span>, as you can see in Figure <span class="InternalRef"><a href="#Fig2">4-2</a></span>.</p></div><div class="Para"><figure class="Figure" id="Fig2"><div class="MediaObject" id="MO2"><img alt="" aria-describedby="d64e553" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig2_HTML.jpg" style="width:42.82em" width="1713" height="343"/><div class="TextObject" id="d64e553"><p class="Para" id="Par178">A screenshot of the file menu bar with an open view tab. The check box of the formula bar option under the view tab is marked.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-2</span><p class="SimplePara">The <span id="ITerm12">Formula Bar</span><span id="ITerm13"></span> visible</p></div></figcaption></figure></div><div class="Para" id="Par22">Let’s examine an M statement, using a simple example shown in Figures <span class="InternalRef"><a href="#Fig3">4-3</a></span> , <span class="InternalRef"><a href="#Fig4">4-4</a></span>, and <span class="InternalRef"><a href="#Fig5">4-5</a></span>. I am going to split a <span id="ITerm14">column</span> into two columns.<figure class="Figure" id="Fig3"><div class="MediaObject" id="MO3"><img alt="" aria-describedby="d64e589" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig3_HTML.jpg" style="width:33.98em" width="1359" height="1677"/><div class="TextObject" id="d64e589"><p class="Para" id="Par179">A screenshot of the comment text window with a single column. A note reads, an example of a column to be split on the first comma.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-3</span><p class="SimplePara">Column to be <span id="ITerm15">split</span></p></div></figcaption></figure><figure class="Figure" id="Fig4"><div class="MediaObject" id="MO4"><img alt="" aria-describedby="d64e607" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig4_HTML.jpg" style="width:42.82em" width="1713" height="1126"/><div class="TextObject" id="d64e607"><p class="Para" id="Par180">A screenshot of the menu selection in the Comment Text window to split the column. The option to split the column by delimiter is selected from a menu list.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-4</span><p class="SimplePara">Splitting the column by <span id="ITerm16">delimiter</span></p></div></figcaption></figure></div><div class="Para" id="Par23">And here are the resulting two columns:<figure class="Figure" id="Fig5"><div class="MediaObject" id="MO5"><img alt="" aria-describedby="d64e628" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig5_HTML.jpg" style="width:42.82em" width="1713" height="1289"/><div class="TextObject" id="d64e628"><p class="Para" id="Par181">A screenshot of the comment text window split into 2 columns. The resulting 2 columns are obtained after splitting the column on the first comma.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-5</span><p class="SimplePara">One <span id="ITerm17">column split</span> into two</p></div></figcaption></figure></div><div class="Para" id="Par24">Now that we have the example set up, let’s look at the M that was generated by this transformation, shown in Figure <span class="InternalRef"><a href="#Fig6">4-6</a></span>.<figure class="Figure" id="Fig6"><div class="MediaObject" id="MO6"><img alt="" aria-describedby="d64e652" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig6_HTML.png" style="width:42.8em" width="1712" height="501"/><div class="TextObject" id="d64e652"><p class="Para" id="Par182">A screenshot of the formula bar with an M statement. The parts of the statement are labeled. The comment text at the bottom has 2 columns. The delimiter option under the applied steps is highlighted.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-6</span><p class="SimplePara">The anatomy of a sample <span id="ITerm18">M statement</span></p></div></figcaption></figure></div></section>
<section class="Section2 RenderAsSection2" id="Sec3"><h3 class="Heading">The M Language</h3><div class="Para" id="Par25">You don’t have to be able to write <span id="ITerm19">M</span><span id="ITerm20"></span> from scratch, but knowing some basic facts about M is helpful:<div class="OrderedList"><ol><li class="ListItem"><div class="ItemNumber">1.</div><div class="ItemContent"><p class="Para" id="Par26">M is a separate language from DAX. It is used in the PQE, not in the Desktop.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">2.</div><div class="ItemContent"><p class="Para" id="Par27"><em class="EmphasisTypeItalic ">M is case sensitive</em>. Pay attention to upper- and lowercase!</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">3.</div><div class="ItemContent"><p class="Para" id="Par28">M is a functional language. You use a function to perform an action.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">4.</div><div class="ItemContent"><p class="Para" id="Par29">An M function has arguments (just like in Excel) that are separated by commas.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">5.</div><div class="ItemContent"><p class="Para" id="Par30">In M, when you see curly braces “{}”, that indicates a list.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">6.</div><div class="ItemContent"><p class="Para" id="Par31">To see the entire script you have written in the query you are working on, open the <span class="EmphasisFontCategoryNonProportional ">Advanced Editor</span> on the <span class="EmphasisFontCategoryNonProportional ">Home</span> tab.</p></div><div class="ClearBoth"> </div></li></ol></div></div><section class="Section3 RenderAsSection3" id="Sec4"><h4 class="Heading">Undoing and Redoing a Step</h4><div class="Para" id="Par32">One of the first things I look for in any application is the <span class="EmphasisFontCategoryNonProportional ">Undo</span> feature. It just makes me feel more secure. But in the Power Query <span id="ITerm21">Editor</span><span id="ITerm22"></span>, you can look all day long, and you will not find an <span class="EmphasisFontCategoryNonProportional ">Undo</span> feature in the ribbon. The way you fix mistakes is by working with the relevant <span class="EmphasisFontCategoryNonProportional ">Applied Step</span>. Each step will have a red X if you mouse over it, as you can see in Figure <span class="InternalRef"><a href="#Fig7">4-7</a></span>. But don’t be hasty—the Power Query Editor is very flexible. You can <span class="EmphasisFontCategoryNonProportional ">Redo</span> a step that has a gear icon next to it. You can also rearrange <span id="ITerm23">steps</span><span id="ITerm24"></span> by dragging them up or down the list.<figure class="Figure" id="Fig7"><div class="MediaObject" id="MO7"><img alt="" aria-describedby="d64e771" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig7_HTML.jpg" style="width:19.28em" width="771" height="701"/><div class="TextObject" id="d64e771"><p class="Para" id="Par183">A screenshot of the applied steps panel. The shaded X sign on the left of the split column by delimiter option is used to delete the step and the gear icon on the right is used to redo it.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-7</span><p class="SimplePara">Undoing or redoing a <span id="ITerm25">step</span></p></div></figcaption></figure></div></section>
</section>
</section>
<section class="Section1 RenderAsSection1" id="Sec5"><h2 class="Heading">Naming and Documenting</h2><p class="Para" id="Par33">In addition to data not meeting your requirements, it often does not have user-friendly names. If your source is a <span id="ITerm26">database</span><span id="ITerm27"></span>, you will often see column names prefixed with the term “DIM” or “FACT”—more on these prefixes in Chapter <span class="ExternalRef"><a href="532800_1_En_5_Chapter.xhtml"><span class="RefSource">5</span></a></span>. You should rename columns and queries with names that make sense to your report readers. Two columns in the same query cannot have the same name, but you can have columns of the same name in different queries. In fact, you should make sure that your key columns have the same names in different queries. That will make it easier for you to relate them in the data model and easier for your report reader to know that they represent the same value.</p><p class="Para" id="Par34">You may have seen names where there are two words joined by an underscore (Name_Name2). Should you have spaces in the names of your columns and queries? Spaces are more familiar to your users, but if you have a space in your table name, you will always have to enclose it with single quotes (e.g., ‘Name Name2’).</p><div class="FormalPara FormalParaRenderingStyle1 ParaTypeImportant" id="FPar2"><div class="Heading">Tip</div><p class="Para FirstParaInFormalPara" id="Par35">Get in the habit of always putting your table name in single quotes—then, when a table name requires single quotes, you won’t be wondering what is wrong.</p></div><p class="Para" id="Par36">If there is a naming convention in your organization, follow it. If there isn’t a naming convention, establish one. Column and query names will be consistent.</p><p class="Para" id="Par37">Rename all your columns in the query as one <span class="EmphasisFontCategoryNonProportional ">Applied Step</span>. That way, when you look for the step where you renamed a column(s), it will be in one step. It doesn’t matter if you do it at the beginning or end of your process, but because you may be creating and deleting columns, you may want to save it until close to the end.</p><div class="Para" id="Par38">You can also rename individual steps, something I advise. Sometimes the <span class="EmphasisFontCategoryNonProportional ">Applied Steps</span> list is quite long—it will be much easier to find a particular step if it is descriptively named. You can name a step by right-clicking it and choosing <span class="EmphasisFontCategoryNonProportional ">Rename</span>. The one type of step I always rename is one in which I have filtered out some data. That way, when I panic, I can easily find that step and undo or redo it, as shown in Figures <span class="InternalRef"><a href="#Fig8">4-8</a></span>, <span class="InternalRef"><a href="#Fig9">4-9</a></span>, and <span class="InternalRef"><a href="#Fig10">4-10</a></span>.<figure class="Figure" id="Fig8"><div class="MediaObject" id="MO8"><img alt="" aria-describedby="d64e843" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig8_HTML.jpg" style="width:25.1em" width="1004" height="1778"/><div class="TextObject" id="d64e843"><p class="Para" id="Par184">A screenshot of the Power Query Editor with filter functionality option. The option removes data from the data model. The screen has a list of countries with marked check boxes except for 2 countries.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-8</span><p class="SimplePara">Filtering out <span id="ITerm28">data</span></p></div></figcaption></figure><figure class="Figure" id="Fig9"><div class="MediaObject" id="MO9"><img alt="" aria-describedby="d64e861" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig9_HTML.jpg" style="width:22.12em" width="885" height="1488"/><div class="TextObject" id="d64e861"><p class="Para" id="Par185">A screenshot of the applied steps panel with the step renaming option. The screen opens a menu with rename option for the filtered rows in the applied steps section.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-9</span><p class="SimplePara">Renaming the resulting <span id="ITerm29">step</span></p></div></figcaption></figure><figure class="Figure" id="Fig10"><div class="MediaObject" id="MO10"><img alt="" aria-describedby="d64e873" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig10_HTML.jpg" style="width:22.12em" width="885" height="751"/><div class="TextObject" id="d64e873"><p class="Para" id="Par186">A screenshot of the applied steps panel. The last option from the list is highlighted. It reads removed the United Kingdom and the United States.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-10</span><p class="SimplePara">Much easier to find when in a panic</p></div></figcaption></figure></div><div class="Para" id="Par39">While you are naming things, it is a good time to document your <span id="ITerm30">query</span> and your steps. On the <span class="EmphasisFontCategoryNonProportional ">Applied Steps</span> panel (on the right of the Power Query Editor window), there is a hyperlink label <span class="EmphasisFontCategoryNonProportional ">All Properties</span>. Click the hyperlink and enter a description of the query as shown in Figure <span class="InternalRef"><a href="#Fig11">4-11</a></span>. <em class="EmphasisTypeItalic ">Bonus:</em> When you bring the query over into the <span class="EmphasisFontCategoryNonProportional ">Desktop</span>, the description will appear in the tooltip for the table!<figure class="Figure" id="Fig11"><div class="MediaObject" id="MO11"><img alt="" aria-describedby="d64e916" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig11_HTML.jpg" style="width:42.82em" width="1713" height="991"/><div class="TextObject" id="d64e916"><p class="Para" id="Par187">A screenshot of the All Properties window for query description. The query settings on the right highlight the all properties option. The screen has entry fields for query properties on the left.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-11</span><p class="SimplePara">Documenting a <span id="ITerm31">query</span></p></div></figcaption></figure></div><div class="Para" id="Par40">Even more importantly, you can document a particular step as shown in Figure <span class="InternalRef"><a href="#Fig12">4-12</a></span>. Right-click the step and choose <span class="EmphasisFontCategoryNonProportional ">Properties</span>. Enter a description of what you did and why.<figure class="Figure" id="Fig12"><div class="MediaObject" id="MO12"><img alt="" aria-describedby="d64e942" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig12_HTML.jpg" style="width:42.82em" width="1713" height="907"/><div class="TextObject" id="d64e942"><p class="Para" id="Par188">A screenshot of the applied steps panel with the step description option. The properties option from the menu opens a dialogue box titled step properties. It has entry fields for name and description.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-12</span><p class="SimplePara"><span id="ITerm32">Documenting</span> a step</p></div></figcaption></figure></div><p class="Para" id="Par41"><em class="EmphasisTypeItalic ">Bonus:</em> If you add a description to a step, a little circle with an “i” in it appears next to it in your <span class="EmphasisFontCategoryNonProportional ">Applied Steps</span> list.</p><div class="FormalPara FormalParaRenderingStyle1 ParaTypeImportant" id="FPar3"><div class="Heading">Tip</div><p class="Para FirstParaInFormalPara" id="Par42">I always document steps when I filter data, remove columns, or make other changes that may not be obvious to me or a colleague after some time has passed.</p></div><p class="Para" id="Par43">There’s an old expression a stitch in time saves nine. It really applies to documentation—do it while you are during the work. You (or your colleagues) will be grateful later!</p><div class="FormalPara FormalParaRenderingStyle1 ParaTypeImportant" id="FPar4"><div class="Heading">Tip</div><p class="Para FirstParaInFormalPara" id="Par44">Any documentation you add will be visible once you have applied your changes (see “Loading Your Queries (or Not)” below).</p></div></section>
<section class="Section1 RenderAsSection1" id="Sec6"><h2 class="Heading">Data Quality and Distribution</h2><div class="Para" id="Par45">If you are connecting to a data source you are not familiar with, you don’t necessarily know what to expect. Will the <span id="ITerm33">data</span><span id="ITerm34"></span> have lots of errors? Will there be a lot of blanks or null values? Inconsistencies? We all hope that the data will be perfect “out of the box,” but this is usually not the case, which is why one of your first steps should be to enable the <span class="EmphasisFontCategoryNonProportional ">Data Preview</span> tools on the <span class="EmphasisFontCategoryNonProportional ">View</span> tab as shown in Figure <span class="InternalRef"><a href="#Fig13">4-13</a></span>. Specifically you should enable:<div class="ProgramCode" id="PC1"><div class="LineGroup"><div class="FixedLine">Column quality</div><div class="FixedLine">Column distribution</div><div class="FixedLine">Column profile</div></div></div></div><div class="Para"><figure class="Figure" id="Fig13"><div class="MediaObject" id="MO13"><img alt="" aria-describedby="d64e1013" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig13_HTML.jpg" style="width:42.82em" width="1713" height="321"/><div class="TextObject" id="d64e1013"><p class="Para" id="Par189">A screenshot of the file menu bar with an open view tab. The checkboxes for column quality, distribution, and profile are marked.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-13</span><p class="SimplePara">Turning on column <span id="ITerm35">profiling</span></p></div></figcaption></figure></div><p class="Para" id="Par46">Each of these features will introduce new elements to your screen real estate, so you may not want these features on all the time. Looking at them when you first bring in the data is a good practice; then you can turn them off after you have assessed your data.</p><div class="Para" id="Par47">Here are some suggestions for things to look for in these boxes:<div class="OrderedList"><ol><li class="ListItem"><div class="ItemNumber">1.</div><div class="ItemContent"><p class="Para" id="Par48">Are there empty or blank values in a column? Decide what your strategy will be for filling these blanks. Do you want to put in a “0” or an “N/A” or a “blank”? Using <span id="ITerm36"><span class="EmphasisFontCategoryNonProportional ">Replace Values</span></span> is a simple way to make these changes, but make sure you know if the empty value is truly blank or is a null. Blanks and nulls are treated differently in the Power Query Editor.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">2.</div><div class="ItemContent"><div class="Para" id="Par49">What is the ratio of <strong class="EmphasisTypeBold ">distinct</strong> to <strong class="EmphasisTypeBold ">unique</strong> <span id="ITerm37">values</span>? <strong class="EmphasisTypeBold ">Distinct</strong> indicates the number of different values present in the column. (If you have a list {1, 2, 3, 4}, there are four distinct values.) <strong class="EmphasisTypeBold ">Unique</strong> indicates the number of values that are not repeated. (In a list {1, 1, 2, 2, 2, 3, 4, 4}, there is only one unique value.) A ratio of one to one (or close to 1/1) means that this column has very high cardinality (shown in Figure <span class="InternalRef"><a href="#Fig14">4-14</a></span>)—a term I will explain below. A ratio of 1 to 0 or 1/0 is good (shown in Figure <span class="InternalRef"><a href="#Fig15">4-15</a></span>). This means that every value is repeated <em class="EmphasisTypeItalic ">at least</em> once.<figure class="Figure" id="Fig14"><div class="MediaObject" id="MO14"><img alt="" aria-describedby="d64e1087" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig14_HTML.jpg" style="width:26.58em" width="1063" height="1221"/><div class="TextObject" id="d64e1087"><p class="Para" id="Par190">A screenshot of a customer I D column. A note mentions that the I D column has a 1 over 1 ratio between the distinct and unique values and none of the values are repeated.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-14</span><p class="SimplePara">Example of a <span id="ITerm38">high-cardinality column</span></p></div></figcaption></figure><figure class="Figure" id="Fig15"><div class="MediaObject" id="MO15"><img alt="" aria-describedby="d64e1105" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig15_HTML.jpg" style="width:26.58em" width="1063" height="1347"/><div class="TextObject" id="d64e1105"><p class="Para" id="Par191">A screenshot of a country column. A note mentions that the column has 21 different countries with only 3 countries listed only once. The column has a very low cardinality.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-15</span><p class="SimplePara">Example of a <span id="ITerm39">low-cardinality column</span></p></div></figcaption></figure></div></div><div class="ClearBoth"> </div></li></ol></div></div><div class="Para" id="Par50"><div class="OrderedList"><ol><li class="ListItem"><div class="ItemNumber">3.</div><div class="ItemContent"><p class="Para" id="Par51">What is the distribution of values? Do you see different types of data in the same column (i.e., text and numeric)? Part of your work will be to make the values in a column a consistent type (either a text or number).</p></div><div class="ClearBoth"> </div></li></ol></div></div><div class="Para" id="Par52">Once you have scanned your data and noted any “problem” areas, you can return to the <span class="EmphasisFontCategoryNonProportional ">View</span> tab and turn off the <span class="EmphasisFontCategoryNonProportional ">Data Preview</span> tools. You will always have the <span class="EmphasisFontCategoryNonProportional ">Profile</span> shortcut bar visible, right under the column headers as shown in Figure <span class="InternalRef"><a href="#Fig16">4-16</a></span>.<figure class="Figure" id="Fig16"><div class="MediaObject" id="MO16"><img alt="" aria-describedby="d64e1145" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig16_HTML.jpg" style="width:42.82em" width="1713" height="863"/><div class="TextObject" id="d64e1145"><p class="Para" id="Par192">A screenshot of the data columns with a profile shortcut bar. Simplified data profiling is available when hovering over the bar under the column header. The bar magnifies the customer I D column data.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-16</span><p class="SimplePara"><span id="ITerm40">Simplified data profiling</span> is always available</p></div></figcaption></figure></div></section>
<section class="Section1 RenderAsSection1" id="Sec7"><h2 class="Heading">Keys and IDs</h2><p class="Para" id="Par53">It makes intuitive sense that every <span id="ITerm41">collection</span><span id="ITerm42"></span> of data has something that uniquely identifies each row (or data point). Otherwise, how would you tell rows apart? Or identify duplicates? A column that contains a unique identifier is called a “key” in database terminology. A key can be native to the data (e.g., an employee ID number in a table with employee information). It can also be something that the database designer has added. Regardless of where the key comes from, it is a unique identifier for the data, and there must be one present for the data model to be constructed.</p><div class="Para" id="Par54">If you are extracting your data from a data warehouse or a database, a column that is the unique identifier is usually going to have the word “key” in its title. But if you don’t see a column with “key” in its name, open the <span class="EmphasisFontCategoryNonProportional ">Data Preview</span> tools and look for a column with a 1/1 ratio for distinct/unique: it is likely to be a “key” field, as shown in Figure <span class="InternalRef"><a href="#Fig17">4-17</a></span>.<figure class="Figure" id="Fig17"><div class="MediaObject" id="MO17"><img alt="" aria-describedby="d64e1186" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig17_HTML.jpg" style="width:26.58em" width="1063" height="1221"/><div class="TextObject" id="d64e1186"><p class="Para" id="Par193">A screenshot of the customer I D column. A note mentions that the I D column has a 1 over 1 ratio between the distinct and unique values and none of the values are repeated.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-17</span><p class="SimplePara">A good example of a <span id="ITerm43">key column</span></p></div></figcaption></figure></div><p class="Para" id="Par55">If you have two columns with a 1/1 ratio, scrutinize each of them to see which you should keep. A key column has (by definition) high cardinality, which means it will be very “expensive” to “store.” I hate to keep putting you off, but we <strong class="EmphasisTypeBold ">will</strong> get to cardinality. (It gets its own section!)</p><p class="Para" id="Par56">When a key column is present in another table, it is called a “<span id="ITerm44">foreign key</span>.” When it is in its own “home” table, it is called a “<span id="ITerm45">primary key</span>.” You may not see these terms directly on the exam, but the concepts they represent are critical. You can connect two tables together by matching the primary and foreign key columns. If we were working in a database, we would call this process “joining.” In Power BI, the term “join” is not used; rather, we create “relationships.” You need to have relationships between tables for the data model to work. (See Chapter <span class="ExternalRef"><a href="532800_1_En_5_Chapter.xhtml"><span class="RefSource">5</span></a></span>.)</p><p class="Para" id="Par57">As part of your transformation <span id="ITerm46">process</span><span id="ITerm47"></span>, you must ensure that each query has a column that serves as the “key.” Simplify this column as much as you can. For example, if the ID has two components (1234-56789) and only one of the components can serve as an ID, split the column and reduce the key down to the minimum number of characters to uniquely identify each row.</p><p class="Para ParaOneEmphasisChild" id="Par58"><em><strong class="EmphasisTypeBoldItalic ">For Future Reference: Native and Surrogate Keys</strong></em></p><p class="Para ParaTypeImportant" id="Par59">A <span id="ITerm48"><strong class="EmphasisTypeBold ">native key</strong></span> is something that the business (or the data owner) uses to uniquely identify a data point, for example, employee ID for employees.</p><p class="Para ParaTypeImportant" id="Par60">A <span id="ITerm49"><strong class="EmphasisTypeBold ">surrogate key</strong></span> is a unique ID that is added to the data by a database owner. The advantage of a surrogate key is that it is independent of the business, so does not change, even if the business changes its methodology for identification.</p><p class="Para ParaTypeImportant" id="Par61">For example, the HR department assigns an employee the ID number XYZ123. The database administrator assigns the same employee the ID number 123456. Both IDs are unique, but the ID 123456 is the surrogate key and never changes even if the HR department changes their ID taxonomy to 123XYZ.</p></section>
<section class="Section1 RenderAsSection1" id="Sec8"><h2 class="Heading">Data Types Matter!</h2><div class="Para" id="Par62">When I taught Excel to beginners, one of the points I emphasized was to <em class="EmphasisTypeItalic ">not</em> leave a column’s data type as General. This is equally (if not more) true in Power BI. The wrong data type is <em class="EmphasisTypeItalic ">not</em> a net-neutral decision. There are some rules that you need to follow when assigning a data type to a column:<div class="OrderedList"><ol><li class="ListItem"><div class="ItemNumber">1.</div><div class="ItemContent"><p class="Para" id="Par63">Currency should be stored as a <span id="ITerm50"><span class="EmphasisFontCategoryNonProportional ">Fixed Decimal</span></span> type. This data type stores a number at four digits of precision <em class="EmphasisTypeItalic ">after</em> the decimal point.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">2.</div><div class="ItemContent"><p class="Para" id="Par64">A <span class="EmphasisFontCategoryNonProportional ">Fixed Decimal</span> <span id="ITerm51">type</span> is <em class="EmphasisTypeItalic ">not</em> the equivalent of a <span class="EmphasisFontCategoryNonProportional ">Decimal</span> type.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">3.</div><div class="ItemContent"><p class="Para" id="Par65">A <span class="EmphasisFontCategoryNonProportional ">Decimal</span> <span id="ITerm52">type</span> stores up to 15 digits, including numbers before <em class="EmphasisTypeItalic ">and</em> after the decimal place. For example, if I have a number that is 13 digits <em class="EmphasisTypeItalic ">before</em> the decimal place, the <span class="EmphasisFontCategoryNonProportional ">Decimal</span> data type will only store two digits <em class="EmphasisTypeItalic ">after</em> the decimal place, resulting in a loss of precision.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">4.</div><div class="ItemContent"><p class="Para" id="Par66">Dates should be stored as a <span class="EmphasisFontCategoryNonProportional ">Date</span> data type. If you need to store a value for <span class="EmphasisFontCategoryNonProportional ">Time</span>, store it in a separate column. (Don’t worry about formatting a date column—that happens in the Power BI Desktop.)</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">5.</div><div class="ItemContent"><div class="Para" id="Par67">If you know your PBIX file will be consumed by someone in a different region of the world, you should assign <span class="EmphasisFontCategoryNonProportional ">Date</span>, <span class="EmphasisFontCategoryNonProportional ">Fixed Decimal</span>, and <span class="EmphasisFontCategoryNonProportional ">Decimal</span> using the <span id="ITerm53"><span class="EmphasisFontCategoryNonProportional ">Locale</span></span> option, shown in Figure <span class="InternalRef"><a href="#Fig18">4-18</a></span>. This feature will properly convert a date from US format (Month/Day/Year) to rest-of-the-world format (Day/Month/Year) automatically. It will do the same for <span class="EmphasisFontCategoryNonProportional ">Fixed Decimal</span> and <span class="EmphasisFontCategoryNonProportional ">Decimal</span>—it switches the decimal place to a comma and vice versa—all without any manual intervention.<figure class="Figure" id="Fig18"><div class="MediaObject" id="MO18"><img alt="" aria-describedby="d64e1410" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig18_HTML.jpg" style="width:42.82em" width="1713" height="1156"/><div class="TextObject" id="d64e1410"><p class="Para" id="Par194">A screenshot of the using locale option in the order date dropdown menu. The using locale option enables the conversion of dates or currency to different formatting conventions.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-18</span><p class="SimplePara">Accessing Using <span id="ITerm54">Locale</span> in the Data Type menu</p></div></figcaption></figure></div></div><div class="ClearBoth"> </div></li></ol></div></div><div class="Para" id="Par68">Once you have accessed <span class="EmphasisFontCategoryNonProportional ">Using</span> <span id="ITerm55"><span class="EmphasisFontCategoryNonProportional ">Locale</span></span><span id="ITerm56"></span>, set the data type as normal, as shown in Figure <span class="InternalRef"><a href="#Fig19">4-19</a></span>.<figure class="Figure" id="Fig19"><div class="MediaObject" id="MO19"><img alt="" aria-describedby="d64e1455" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig19_HTML.jpg" style="width:42.82em" width="1713" height="907"/><div class="TextObject" id="d64e1455"><p class="Para" id="Par195">A screenshot of the window titled change type with locale. The date option is selected from the data type dropdown menu. A note mentions that the data type in the using locale menu is chosen as normal.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-19</span><p class="SimplePara">Set the data type <span id="ITerm57">as normal</span></p></div></figcaption></figure></div><div class="Para" id="Par69"><div class="OrderedList"><ol><li class="ListItem"><div class="ItemNumber">6.</div><div class="ItemContent"><p class="Para" id="Par70">If you can store a value as a <span id="ITerm58"><span class="EmphasisFontCategoryNonProportional ">Whole Number</span></span>, do so. A whole number is going to be the “cheapest” way to store values.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">7.</div><div class="ItemContent"><p class="Para" id="Par71">If you can avoid storing a value as a <span class="EmphasisFontCategoryNonProportional ">Text</span> <span id="ITerm59">value</span>, do so. String (text) values are the most “expensive” way to store values.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">8.</div><div class="ItemContent"><p class="Para" id="Par72">If you have two columns in two different queries that will be used to link the two tables together (once we get to the Power BI Desktop), make sure that the two columns have the same data type. (As mentioned earlier, it is nice if they have the same name as well, but that isn’t strictly required.)</p></div><div class="ClearBoth"> </div></li></ol></div></div><p class="Para ParaOneEmphasisChild" id="Par73"><em><strong class="EmphasisTypeBoldItalic ">Food for Thought</strong></em></p><p class="Para ParaTypeImportant" id="Par74">A colleague told me he once saved 30% in his overall data model size by changing a column from the text data type to the whole number data type. Indeed, data types matter!</p><p class="Para" id="Par75">Be deliberate and intentional in your data type choices. Checking the data types should be the last thing you do before you finish your query transformations. Watch out for extra <span class="EmphasisFontCategoryNonProportional ">Changed Type</span> <span id="ITerm60">steps</span>. You are usually safe removing these as they appear in your list of steps. Most of the time they are unnecessary. (There are always exceptions. If the <span class="EmphasisFontCategoryNonProportional ">Changed Type</span> is necessary to perform a step below it, do not delete it. You will break the subsequent steps.)</p></section>
<section class="Section1 RenderAsSection1" id="Sec9"><h2 class="Heading">For Future Reference: Query Folding</h2><p class="Para" id="Par76">This is the feature you don’t know you need until you break it. When you connect to a data source that is powered by something (meaning a server), you can “fold” the work of doing the transformations back to that engine. For example, if you connect to a data source on SQL Server, there’s an excellent chance that the server supports <span id="ITerm61">folding</span><span id="ITerm62"></span>. If so, the PQE is going to fold back the transformations to the server to perform them and thus get them done faster. (Servers <em class="EmphasisTypeItalic ">typically</em> have more power than our laptops.) <em class="EmphasisTypeItalic ">But there are some transformations that will break query folding, and changing a data type is one of them (usually).</em> That’s why I said that you should delete any gratuitous <span class="EmphasisFontCategoryNonProportional ">Changed Type</span> steps that the PQE creates. That is also why I said that changing data types should be the <em class="EmphasisTypeItalic ">last</em> step you perform on your query. All the previous steps will be folded back, speeding up the process.</p><p class="Para" id="Par77">There are sources that have no underlying “engines”: Excel, CSV, and PDF come to mind. When a query originates from one of these types of sources, there is no query folding. One school of thought is “don’t worry about breaking query folding in these queries.” But I disagree.</p><div class="FormalPara FormalParaRenderingStyle1 ParaTypeImportant" id="FPar5"><div class="Heading">Tip</div><p class="Para FirstParaInFormalPara" id="Par78">Practice the same good habits regardless of whether the query type supports folding. Then you won’t accidently break folding when it <em class="EmphasisTypeItalic ">is</em> available because of sloppy practices.</p></div><div class="Para" id="Par79">How do you know if <span id="ITerm63"><span class="EmphasisFontCategoryNonProportional ">query folding</span></span><span id="ITerm64"></span> is happening (or not)? On your <span class="EmphasisFontCategoryNonProportional ">Applied Steps</span> panel, select a step and right-click. If the <span class="EmphasisFontCategoryNonProportional ">View Native Query</span> is grayed out, then <span class="EmphasisFontCategoryNonProportional ">query folding</span> is <em class="EmphasisTypeItalic ">not</em> happening. In Figure <span class="InternalRef"><a href="#Fig20">4-20</a></span>, <span class="EmphasisFontCategoryNonProportional ">query folding</span> is happening.<figure class="Figure" id="Fig20"><div class="MediaObject" id="MO20"><img alt="" aria-describedby="d64e1629" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig20_HTML.jpg" style="width:22.12em" width="885" height="1042"/><div class="TextObject" id="d64e1629"><p class="Para" id="Par196">A screenshot of the applied steps panel. The navigation option in the panel is highlighted and the view native query option is selected from a popup menu. The selected option has a bright background.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-20</span><p class="SimplePara"><span id="ITerm65">Query folding</span><span id="ITerm66"></span> is occurring in this step</p></div></figcaption></figure></div><div class="Para" id="Par80">If you think it should be, go back up your list of steps until you find the step where it was broken. (Remember, it will <em class="EmphasisTypeItalic ">never</em> work with Excel, CSV, or PDF.) If <span class="EmphasisFontCategoryNonProportional ">View Native Query</span> is an active option, click it. A window will then open in which you can see the M translated into the “native” language of the source server as shown in Figure <span class="InternalRef"><a href="#Fig21">4-21</a></span>.<figure class="Figure" id="Fig21"><div class="MediaObject" id="MO21"><img alt="" aria-describedby="d64e1658" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig21_HTML.jpg" style="width:42.82em" width="1713" height="774"/><div class="TextObject" id="d64e1658"><p class="Para" id="Par197">A screenshot of the native query window. It has 15 lines of code.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-21</span><p class="SimplePara">Example of a <span id="ITerm67">native query</span></p></div></figcaption></figure></div><p class="Para" id="Par81">One final note: <span id="ITerm68"><span class="EmphasisFontCategoryNonProportional ">Query folding</span></span><span id="ITerm69"></span> is probably <em class="EmphasisTypeItalic ">not</em> going to show up on the PL-300, but while I want to help you pass the exam, I <em class="EmphasisTypeItalic ">also</em> want you to become a skilled Power BI practitioner. Knowing how to use <span class="EmphasisFontCategoryNonProportional ">query folding</span> to speed up your transformations is one skill that you should have.</p><p class="Para ParaOneEmphasisChild" id="Par82"><em><strong class="EmphasisTypeBoldItalic ">Your Chance to Practice</strong></em></p><p class="Para ParaTypeImportant" id="Par83">Look up Alex Powers’ 30 days of query folding on YouTube. It is a great opportunity to understand what steps do (and don’t) break folding.</p></section>
<section class="Section1 RenderAsSection1" id="Sec10"><h2 class="Heading">Replacing Data</h2><section class="Section2 RenderAsSection2" id="Sec11"><h3 class="Heading">Blanks and Nulls</h3><div class="Para" id="Par84">The Power Query Editor treats <span class="EmphasisFontCategoryNonProportional ">Null</span> and <span class="EmphasisFontCategoryNonProportional ">Blank</span> <span id="ITerm70">values</span> differently. For both values, you use the same technique to replace them: <span class="EmphasisFontCategoryNonProportional ">Replace Values</span> as shown in Figures <span class="InternalRef"><a href="#Fig22">4-22</a></span> and <span class="InternalRef"><a href="#Fig23">4-23</a></span>.<figure class="Figure" id="Fig22"><div class="MediaObject" id="MO22"><img alt="" aria-describedby="d64e1745" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig22_HTML.jpg" style="width:32.48em" width="1299" height="1578"/><div class="TextObject" id="d64e1745"><p class="Para" id="Par198">A screenshot captures the path for data replacement. The screen has a vendor name column in the backdrop. A text reads, right-click on the column with null values and choose the replace values option.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-22</span><p class="SimplePara">Replacing <span id="ITerm71">values</span> in a column</p></div></figcaption></figure><figure class="Figure" id="Fig23"><div class="MediaObject" id="MO23"><img alt="" aria-describedby="d64e1764" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig23_HTML.png" style="width:35.62em" width="1425" height="606"/><div class="TextObject" id="d64e1764"><p class="Para" id="Par199">A screenshot of the replace values dialogue box. It has 2 entry fields for value to find and replace with. A note mentions that for null values, null is entered into the value to find box.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-23</span><p class="SimplePara">For <span id="ITerm72">null values</span>, be sure to enter “null”</p></div></figcaption></figure></div><p class="Para" id="Par86">For blank values, leave the <span class="EmphasisFontCategoryNonProportional ">Value To Find</span> box empty.</p></section>
<section class="Section2 RenderAsSection2" id="Sec12"><h3 class="Heading">Errors</h3><div class="Para" id="Par87"><span id="ITerm73">Errors</span><span id="ITerm74"></span> are a little trickier. If you are lucky enough to have all the errors show up in the first 1000 rows, you can review them and determine the issue. You can see the error source by clicking the cell with the error, as shown in Figure <span class="InternalRef"><a href="#Fig24">4-24</a></span>.<figure class="Figure" id="Fig24"><div class="MediaObject" id="MO24"><img alt="" aria-describedby="d64e1811" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig24_HTML.png" style="width:42.82em" width="1713" height="646"/><div class="TextObject" id="d64e1811"><p class="Para" id="Par200">A screenshot of data columns with error cells. Clicking an error cell in the vendor number column opens a message at the bottom that reads, data format error with an invalid cell value.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-24</span><p class="SimplePara">Displaying the reason for the <span id="ITerm75">error</span><span id="ITerm76"></span></p></div></figcaption></figure></div><div class="Para" id="Par88">You can also click the hyperlink for the <span id="ITerm77">error</span><span id="ITerm78"></span>. This will result in a new step being added, which may not be necessary for diagnosis. If you right-click the <span class="EmphasisFontCategoryNonProportional ">Data Quality peek</span> bar, there is a contextual menu specifically for handling errors, as shown in Figure <span class="InternalRef"><a href="#Fig25">4-25</a></span>.<figure class="Figure" id="Fig25"><div class="MediaObject" id="MO25"><img alt="" aria-describedby="d64e1854" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig25_HTML.jpg" style="width:26.78em" width="1071" height="1075"/><div class="TextObject" id="d64e1854"><p class="Para" id="Par201">A screenshot of a data column with a data quality peek bar under the header. By right-clicking the bar, a popup menu opens which is specific to errors.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-25</span><p class="SimplePara">Several options for handling <span id="ITerm79">errors</span><span id="ITerm80"></span></p></div></figcaption></figure></div><div class="Para" id="Par89">You can remove or replace the errors from this menu. But what if you suspect that you have errors in rows that are not included in the first 1000 rows? You can set the Power Query Editor to profile all the rows of your data. There is a drop-down box on the bottom left-hand side of the screen you can toggle, as shown in Figure <span class="InternalRef"><a href="#Fig26">4-26</a></span>.<figure class="Figure" id="Fig26"><div class="MediaObject" id="MO26"><img alt="" aria-describedby="d64e1877" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig26_HTML.jpg" style="width:32.48em" width="1299" height="357"/><div class="TextObject" id="d64e1877"><p class="Para" id="Par202">A screenshot of the profiling behavior change facility. The profiling can be changed from the first 1000 rows to the entire data set by clicking the options in the bottom left corner of the window.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-26</span><p class="SimplePara">Changing the profiling <span id="ITerm81">behavior</span></p></div></figcaption></figure></div><div class="Para" id="Par90">Once the profiling <span id="ITerm82">behavior</span><span id="ITerm83"></span> is changed, the <span class="EmphasisFontCategoryNonProportional ">Data Quality peek</span> will reflect all the rows. If there are errors, they will be highlighted under the <span class="EmphasisFontCategoryNonProportional ">Error</span> category, shown in Figure <span class="InternalRef"><a href="#Fig27">4-27</a></span>.<figure class="Figure" id="Fig27"><div class="MediaObject" id="MO27"><img alt="" aria-describedby="d64e1918" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig27_HTML.jpg" style="width:23.62em" width="945" height="1206"/><div class="TextObject" id="d64e1918"><p class="Para" id="Par203">A screenshot of the product code column data. Once the profiling behavior is changed, the data quality peek reflects all the rows and the error percentage.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-27</span><p class="SimplePara">After changing the profiling <span id="ITerm84">behavior</span></p></div></figcaption></figure></div><p class="Para" id="Par91">This example does not have errors, but if it did, they would be reflected in the <span class="EmphasisFontCategoryNonProportional ">Error</span> category in the <span class="EmphasisFontCategoryNonProportional ">Data Quality peek</span>.</p><div class="Para" id="Par92">If the <span id="ITerm85">errors</span><span id="ITerm86"></span> are not present in the first 1000 rows, how can you determine how to fix them? Use the <span class="EmphasisFontCategoryNonProportional ">Keep Errors</span> option in the <span class="EmphasisFontCategoryNonProportional ">Data Quality peek</span> context menu, as shown in Figure <span class="InternalRef"><a href="#Fig28">4-28</a></span>.<figure class="Figure" id="Fig28"><div class="MediaObject" id="MO28"><img alt="" aria-describedby="d64e1970" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig28_HTML.jpg" style="width:22.12em" width="885" height="908"/><div class="TextObject" id="d64e1970"><p class="Para" id="Par204">A screenshot of a popup menu that is specific to errors. The menu opens by right-clicking the data quality peek bar. The keep errors option is selected from the menu.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-28</span><p class="SimplePara">Choose Keep <span id="ITerm87">Errors</span><span id="ITerm88"></span></p></div></figcaption></figure></div><div class="Para" id="Par93">You will now have a query with just the <span id="ITerm89">errors</span><span id="ITerm90"></span>, as you can see in Figure <span class="InternalRef"><a href="#Fig29">4-29</a></span>. (It might be a good idea to duplicate the query first if you want to preserve the query in its original state. Duplicating a query is discussed below.)<figure class="Figure" id="Fig29"><div class="MediaObject" id="MO29"><img alt="" aria-describedby="d64e2011" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig29_HTML.jpg" style="width:42.82em" width="1713" height="823"/><div class="TextObject" id="d64e2011"><p class="Para" id="Par205">A screenshot of the data column rows with errors. The keep errors option shows just the errors in the query. The applied steps panel on the right highlights the kept errors options.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-29</span><p class="SimplePara">Now only the <span id="ITerm91">errors</span><span id="ITerm92"></span> are displayed</p></div></figcaption></figure></div><p class="Para" id="Par94">Now you can diagnose the <span id="ITerm93">errors</span><span id="ITerm94"></span> and take the appropriate measures to fix them.</p></section>
</section>
<section class="Section1 RenderAsSection1" id="Sec13"><h2 class="Heading">Adding New Data</h2><p class="Para" id="Par95">If only the data sources to which we connect had all the data we needed! But all too frequently the source(s) you are using lacks something important. There are two types of new data you can create in the Power Query Editor: a new column or a new table.</p><section class="Section2 RenderAsSection2" id="Sec14"><h3 class="Heading">Adding a New Column</h3><div class="Para" id="Par96">There are several ways to <span id="ITerm95">create new columns</span>:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par97">Column from Examples</p></li><li><p class="Para" id="Par98">Custom Column</p></li><li><p class="Para" id="Par99">Conditional Column</p></li><li><p class="Para" id="Par100">Index Column</p></li><li><p class="Para" id="Par101">Duplicate Column</p></li></ul></div></div><div class="Para" id="Par102">The correct option is the one that most efficiently performs the necessary task. For example, if you want to add a new column with the country “United States,” you could use either <span class="EmphasisFontCategoryNonProportional ">Column from Examples</span> or <span class="EmphasisFontCategoryNonProportional ">Custom Column</span>. Figures <span class="InternalRef"><a href="#Fig30">4-30</a></span> and <span class="InternalRef"><a href="#Fig31">4-31</a></span> show both methods.<figure class="Figure" id="Fig30"><div class="MediaObject" id="MO30"><img alt="" aria-describedby="d64e2094" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig30_HTML.png" style="width:42.8em" width="1712" height="928"/><div class="TextObject" id="d64e2094"><p class="Para" id="Par206">A screenshot captures the column addition process. The United States of America is typed in the sixth column on the right and Power B I determines a pattern and suggest it in the remaining rows.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-30</span><p class="SimplePara">Adding a column from <span id="ITerm96">examples</span></p></div></figcaption></figure><figure class="Figure" id="Fig31"><div class="MediaObject" id="MO31"><img alt="" aria-describedby="d64e2114" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig31_HTML.png" style="width:35.48em" width="1419" height="864"/><div class="TextObject" id="d64e2114"><p class="Para" id="Par207">A screenshot of the custom column window. It has entry fields for a new column name and a custom column formula. A note mentions that the formula in the custom column has to be written in M.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-31</span><p class="SimplePara">Adding a <span id="ITerm97">custom column</span></p></div></figcaption></figure></div><p class="Para" id="Par103">I have provided these two examples to illustrate that there will often be several ways to perform the same <span id="ITerm98">task</span>. Which method you choose will vary based on your understanding of each technique and the requirements of your task.</p></section>
<section class="Section2 RenderAsSection2" id="Sec15"><h3 class="Heading">Adding a New Query</h3><p class="Para" id="Par104">To create a new <span id="ITerm99">query</span>, you have several options. You can create a blank query—essentially a blank sheet of paper. You can also duplicate an existing query, something we will cover in detail later in this chapter.</p></section>
</section>
<section class="Section1 RenderAsSection1" id="Sec16"><h2 class="Heading">Keep Only What You Need</h2><p class="Para" id="Par105">I tell my students that the Power Query Editor is very forgiving. It will allow you to easily fix or change a step that you created earlier in the process; very few decisions are irreversible. With that in mind, be ruthless as you look at your queries. Don’t need a column? Remove it. Don’t need an entire query but just part of it? Combine it with another query, either as a merge or append. <em class="EmphasisTypeItalic ">One of your main objectives is to streamline and simplify the data before you bring it into the Power BI Desktop</em>. Do <em class="EmphasisTypeItalic ">not</em> bring a query or a column over “just in case.” You can always come back for it.</p><section class="Section2 RenderAsSection2" id="Sec17"><h3 class="Heading">Combining Queries</h3><section class="Section3 RenderAsSection3" id="Sec18"><h4 class="Heading">Append</h4><div class="Para" id="Par106">Imagine a <span id="ITerm100">scenario</span> in which you have 12 different Excel worksheets, each for a different month in the year. You bring each of them into the PQE, and now you have 12 different queries. You have a perfect opportunity to streamline the queries. You can choose to append all of them into one new query (e.g., <span class="EmphasisFontCategoryNonProportional ">Append Queries as New</span>) or append them into an existing query (e.g., append February into the January query and so on). In Figures <span class="InternalRef"><a href="#Fig32">4-32</a></span>, <span class="InternalRef"><a href="#Fig33">4-33</a></span>, and <span class="InternalRef"><a href="#Fig34">4-34</a></span>, there are four queries that will be combined into one separate query. (In these examples I am using <span class="EmphasisFontCategoryNonProportional ">Append</span>, but these remarks apply equally to <span class="EmphasisFontCategoryNonProportional ">Merge</span>.)<figure class="Figure" id="Fig32"><div class="MediaObject" id="MO32"><img alt="" aria-describedby="d64e2205" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig32_HTML.jpg" style="width:42.82em" width="1713" height="579"/><div class="TextObject" id="d64e2205"><p class="Para" id="Par208">A screenshot captures the path to append queries together into a new query. The path includes home, append queries, and append queries as new.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-32</span><p class="SimplePara">Appending queries as a new <span id="ITerm101">query</span></p></div></figcaption></figure></div><div class="Para" id="Par107">The following <span id="ITerm102">dialogue</span> box will open:<figure class="Figure" id="Fig33"><div class="MediaObject" id="MO33"><img alt="" aria-describedby="d64e2235" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig33_HTML.jpg" style="width:38.62em" width="1545" height="956"/><div class="TextObject" id="d64e2235"><p class="Para" id="Par209">A screenshot of the append window. A box on the left lists the available tables, an add button with right arrowheads is at the center, and another box has tables to append.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-33</span><p class="SimplePara">Appending multiple queries into a new <span id="ITerm103">one</span></p></div></figcaption></figure><figure class="Figure" id="Fig34"><div class="MediaObject" id="MO34"><img alt="" aria-describedby="d64e2253" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig34_HTML.jpg" style="width:26.58em" width="1063" height="535"/><div class="TextObject" id="d64e2253"><p class="Para" id="Par210">A screenshot of a window that lists the queries. The new query titled Append 1 is added to the bottom of the query list.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-34</span><p class="SimplePara">The <span id="ITerm104">new query</span></p></div></figcaption></figure></div></section>
<section class="Section3 RenderAsSection3" id="Sec19"><h4 class="Heading">Merging</h4><p class="Para" id="Par108">The mechanics of <span id="ITerm105">merging</span> two queries are like those you use when appending, with one key difference. When <span id="ITerm106">appending</span>, it is a good idea to ensure that the structures of both queries (number, name, data types of columns) are the same. With a merge, it is important to understand exactly how you want to merge the two queries. There are seven different join patterns, which I will explain in the following.</p><div class="Para" id="Par109">The default join is a <span id="ITerm107">left outer join</span> (Figure <span class="InternalRef"><a href="#Fig35">4-35</a></span>). In a left outer join, records in one query are compared with records in a second query. Because a picture can replace 1000 words, I am illustrating each type of join with a simple diagram.<figure class="Figure" id="Fig35"><div class="MediaObject" id="MO35"><img alt="" aria-describedby="d64e2304" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig35_HTML.jpg" style="width:42.82em" width="1713" height="609"/><div class="TextObject" id="d64e2304"><p class="Para" id="Par211">A screenshot of 3 query tables titled query A, query B, and merged query. The rows in queries A and B with matching values will be merged and the rest from B will appear null in the merged.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-35</span><p class="SimplePara"><span id="ITerm108">Left outer join</span>: all rows from the left, matching from the right</p></div></figcaption></figure></div><div class="Para" id="Par110">The next most common type of join is a <span id="ITerm109">right outer join</span>. This is the inverse of a <span class="EmphasisFontCategoryNonProportional ">left outer join</span> (Figure <span class="InternalRef"><a href="#Fig36">4-36</a></span>).<figure class="Figure" id="Fig36"><div class="MediaObject" id="MO36"><img alt="" aria-describedby="d64e2337" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig36_HTML.jpg" style="width:42.82em" width="1713" height="597"/><div class="TextObject" id="d64e2337"><p class="Para" id="Par212">A screenshot of 3 query tables titled query A, query B, and merged query. The rows from query B are matched to rows in query A and the remaining rows from A will have a null value in the merged.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-36</span><p class="SimplePara"><span id="ITerm110">Right outer join</span>: All rows from the right, matching from the left</p></div></figcaption></figure></div><div class="Para" id="Par111">Next up is a <span class="EmphasisFontCategoryNonProportional ">full outer join</span><span id="ITerm111"></span> (Figure <span class="InternalRef"><a href="#Fig37">4-37</a></span>). This type of join merges the two queries regardless of matches.<figure class="Figure" id="Fig37"><div class="MediaObject" id="MO37"><img alt="" aria-describedby="d64e2370" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig37_HTML.jpg" style="width:42.82em" width="1713" height="647"/><div class="TextObject" id="d64e2370"><p class="Para" id="Par213">A screenshot of 3 query tables titled query A, query B, and merged query. All rows from query A and query b are merged.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-37</span><p class="SimplePara"><span id="ITerm112">Full outer join</span>: all rows from both queries</p></div></figcaption></figure></div><div class="Para" id="Par112">The <span id="ITerm113"><span class="EmphasisFontCategoryNonProportional ">full outer join</span></span><span id="ITerm114"></span> (Figure <span class="InternalRef"><a href="#Fig38">4-38</a></span>) is very effective for identifying where two queries do not match up. The direct opposite of the <span class="EmphasisFontCategoryNonProportional ">full outer join</span> is the <span class="EmphasisFontCategoryNonProportional ">inner join</span>.<figure class="Figure" id="Fig38"><div class="MediaObject" id="MO38"><img alt="" aria-describedby="d64e2416" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig38_HTML.jpg" style="width:43.05em" width="1722" height="558"/><div class="TextObject" id="d64e2416"><p class="Para" id="Par214">A screenshot of 3 query tables titled query A, query B, and merged query. Only the rows that are matched in both queries are merged.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-38</span><p class="SimplePara"><span id="ITerm115">Inner join</span>: only rows that are present in both queries</p></div></figcaption></figure></div><div class="Para" id="Par113">By now you have probably figured out what is next: the <span id="ITerm116"><span class="EmphasisFontCategoryNonProportional ">left anti join</span></span> (Figure <span class="InternalRef"><a href="#Fig39">4-39</a></span>).<figure class="Figure" id="Fig39"><div class="MediaObject" id="MO39"><img alt="" aria-describedby="d64e2451" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig39_HTML.jpg" style="width:42.82em" width="1713" height="556"/><div class="TextObject" id="d64e2451"><p class="Para" id="Par215">A screenshot of 3 query tables titled query A, query B, and merged query. Only the rows from query A that are not matched in query B are merged.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-39</span><p class="SimplePara"><span id="ITerm117">Left anti join</span>: only rows in Query A that are not matched</p></div></figcaption></figure></div><div class="Para" id="Par114">Next up, the <span id="ITerm118"><span class="EmphasisFontCategoryNonProportional ">right anti join</span></span> (Figure <span class="InternalRef"><a href="#Fig40">4-40</a></span>).<figure class="Figure" id="Fig40"><div class="MediaObject" id="MO40"><img alt="" aria-describedby="d64e2486" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig40_HTML.jpg" style="width:42.82em" width="1713" height="555"/><div class="TextObject" id="d64e2486"><p class="Para" id="Par216">A screenshot of 3 query tables titled query A, query B, and merged query. Only rows in query B that are not matched in query A are merged.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-40</span><p class="SimplePara"><span id="ITerm119">Right anti join</span>: only rows in Query B that are not matched</p></div></figcaption></figure></div><div class="Para" id="Par115">Finally, the <span id="ITerm120"><span class="EmphasisFontCategoryNonProportional ">full anti join</span></span> (Figure <span class="InternalRef"><a href="#Fig41">4-41</a></span>).<figure class="Figure" id="Fig41"><div class="MediaObject" id="MO41"><img alt="" aria-describedby="d64e2521" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig41_HTML.jpg" style="width:42.82em" width="1713" height="555"/><div class="TextObject" id="d64e2521"><p class="Para" id="Par217">A screenshot of 3 query tables titled query A, query B, and merged query. The rows from both query A and query B that are not matched are merged.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-41</span><p class="SimplePara"><span id="ITerm121">Full anti join</span>: only rows in both queries that are not matched</p></div></figcaption></figure></div></section>
</section>
<section class="Section2 RenderAsSection2" id="Sec20"><h3 class="Heading">Duplicating a query</h3><div class="Para" id="Par116">In the preceding example, one option you have is to duplicate one of the <span id="ITerm122">queries</span> and then append all the other queries into the duplicate. When you duplicate a query, you are making an exact copy, shown in Figure <span class="InternalRef"><a href="#Fig42">4-42</a></span>. There are other times when duplicating a query is helpful, for example, when you need to preserve the original query as it is.<figure class="Figure" id="Fig42"><div class="MediaObject" id="MO42"><img alt="" aria-describedby="d64e2554" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig42_HTML.jpg" style="width:35.45em" width="1418" height="1006"/><div class="TextObject" id="d64e2554"><p class="Para" id="Par218">A screenshot captures the process of creating a duplicate query. The screen has a list of queries and clicking right on a query opens a popup menu. The duplicate option is then selected.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-42</span><p class="SimplePara">Duplicating a <span id="ITerm123">query</span></p></div></figcaption></figure></div><p class="Para ParaOneEmphasisChild" id="Par117"><em><strong class="EmphasisTypeBoldItalic ">A Matter of Style</strong></em></p><p class="Para ParaTypeImportant" id="Par118">Lots of choices you make in the Power Query Editor are questions of style. When appending files, I prefer to append (or merge) them all into one new query, leaving the originals as is. But this isn’t a “must-do.” Experiment with different methods so that you can choose the right one in each circumstance.</p></section>
<section class="Section2 RenderAsSection2" id="Sec21"><h3 class="Heading">Referencing a Query</h3><div class="Para" id="Par119">Now let’s think about it another way. What if the original query has many <span class="EmphasisFontCategoryNonProportional ">Applied Steps</span> (transformations) and you are still working on it, but you need to copy the query and have it reflect all the work you are <em class="EmphasisTypeItalic ">continuing</em> to do on the original query? <span id="ITerm124">Reference</span> the original query as shown in Figure <span class="InternalRef"><a href="#Fig43">4-43</a></span>. It will create a second version of the query, but any changes you make in the original query will cascade to the second version.<figure class="Figure" id="Fig43"><div class="MediaObject" id="MO43"><img alt="" aria-describedby="d64e2598" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig43_HTML.jpg" style="width:29.33em" width="1173" height="951"/><div class="TextObject" id="d64e2598"><p class="Para" id="Par219">A screenshot captures the process of creating a referenced query copy. The screen has a list of queries and clicking right on a query opens a popup menu. The reference option is then selected.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-43</span><p class="SimplePara">Referencing a <span id="ITerm125">query</span></p></div></figcaption></figure></div></section>
<section class="Section2 RenderAsSection2" id="Sec22"><h3 class="Heading">Deleting a Query</h3><div class="Para" id="Par120">You can delete a <span id="ITerm126">query</span> if you don’t need it as shown in Figure <span class="InternalRef"><a href="#Fig44">4-44</a></span>.<figure class="Figure" id="Fig44"><div class="MediaObject" id="MO44"><img alt="" aria-describedby="d64e2631" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig44_HTML.jpg" style="width:23.62em" width="945" height="1706"/><div class="TextObject" id="d64e2631"><p class="Para" id="Par220">A screenshot captures the path to delete a query. The supplier query is selected from the list. Clicking right on the query opens a popup menu. The delete option is then selected.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-44</span><p class="SimplePara">Deleting a <span id="ITerm127">query</span></p></div></figcaption></figure></div><p class="Para" id="Par121">You <em class="EmphasisTypeItalic ">can’t</em> delete a <span id="ITerm128">query</span> that is being used in another query (e.g., if you have appended or merged it into another query).</p></section>
</section>
<section class="Section1 RenderAsSection1" id="Sec23"><h2 class="Heading">Working with Some Data</h2><p class="Para" id="Par122">If your data has millions of rows, you do not need (or want) to work with all the rows to decide on your transformations. Or you may not want certain rows to appear in the final report. Either way, you can <span id="ITerm129">filter</span> your data in the <span class="EmphasisFontCategoryNonProportional ">PQE</span> to limit what you are working with. Filtering <em class="EmphasisTypeItalic ">excludes</em> rows that do not meet the filter conditions. <em class="EmphasisTypeItalic ">These rows will not appear in the finished report</em>. If you want to work with only a subset of the data during the report development process, remember to remove the steps in which you limited the rows <em class="EmphasisTypeItalic ">before</em> publishing the report.</p><section class="Section2 RenderAsSection2" id="Sec24"><h3 class="Heading">Only 1000 Rows?</h3><div class="Para" id="Par123">In the lower-left corner, the Power Query Editor displays the number of columns the query has and how many rows it has scanned (previewed)—<em class="EmphasisTypeItalic ">up to 1000 rows</em><span id="ITerm130"></span>. At first glance this seems problematic, but it isn’t because you are not <em class="EmphasisTypeItalic ">actually</em> transforming the data right now. You are writing a script of transformations that will be performed on the data when you load the data into the Desktop. (Don’t worry. You haven’t missed that part—we haven’t gotten there yet.) All you need is a <em class="EmphasisTypeItalic ">representative</em> sample of the data. The presumption is that 1000 rows are sufficient for you to understand the structure and layout of the data and make appropriate decisions. If you need to see more values, you can use <span class="EmphasisFontCategoryNonProportional ">Filters</span> ➤ <span class="EmphasisFontCategoryNonProportional ">Load more</span> to see up to 1000 unique <span id="ITerm131">values</span> in each column, as shown in Figure <span class="InternalRef"><a href="#Fig45">4-45</a></span>.<figure class="Figure" id="Fig45"><div class="MediaObject" id="MO45"><img alt="" aria-describedby="d64e2724" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig45_HTML.jpg" style="width:35.45em" width="1418" height="1503"/><div class="TextObject" id="d64e2724"><p class="Para" id="Par221">A screenshot of the filter panel in the manufacturer column. The load more option on the bottom right is clicked to view more values in case the displayed list of manufacturers is incomplete.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-45</span><p class="SimplePara">Using the <span id="ITerm132">Filters panel</span> to see all the unique values in a column</p></div></figcaption></figure></div><div class="Para" id="Par124">But there’s a hitch: the <span class="EmphasisFontCategoryNonProportional ">Filters</span> panel cannot display more than 1000 unique values, as you can see in Figure <span class="InternalRef"><a href="#Fig46">4-46</a></span>.<figure class="Figure" id="Fig46"><div class="MediaObject" id="MO46"><img alt="" aria-describedby="d64e2750" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig46_HTML.jpg" style="width:25.1em" width="1004" height="1908"/><div class="TextObject" id="d64e2750"><p class="Para" id="Par222">A screenshot of the product name column with a filter panel. The filter panel displays 1000 unique values.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-46</span><p class="SimplePara"><span id="ITerm133">Only 1000 unique values</span> can be displayed</p></div></figcaption></figure></div><div class="Para" id="Par125">If you have more than 1000 unique <span id="ITerm134">values</span> and you need to filter some out, you must use the manual filters to create the filter you need as shown in Figure <span class="InternalRef"><a href="#Fig47">4-47</a></span>.<figure class="Figure" id="Fig47"><div class="MediaObject" id="MO47"><img alt="" aria-describedby="d64e2780" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig47_HTML.jpg" style="width:35.45em" width="1418" height="1747"/><div class="TextObject" id="d64e2780"><p class="Para" id="Par223">A screenshot of the text filter and the product name column. A note reads, if the data has more than 1000 unique values, then a manual filter like a text filter is used to build a filter.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-47</span><p class="SimplePara">Creating a manual <span id="ITerm135">filter</span></p></div></figcaption></figure></div><div class="Para" id="Par126">If you cannot filter without seeing all of the data, you <em class="EmphasisTypeItalic ">can</em> scroll through your data, shown in Figure <span class="InternalRef"><a href="#Fig48">4-48</a></span>.<figure class="Figure" id="Fig48"><div class="MediaObject" id="MO48"><img alt="" aria-describedby="d64e2806" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig48_HTML.png" style="width:42.8em" width="1712" height="369"/><div class="TextObject" id="d64e2806"><p class="Para" id="Par224">A screenshot of a window with multiple data columns. The screen has row numbers well past 1000 and the scroll bar on the right is used to scan through the data.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-48</span><p class="SimplePara">Scrolling through data in the Preview <span id="ITerm136">window</span></p></div></figcaption></figure></div><p class="Para" id="Par127">Scrolling through thousands of rows of <span id="ITerm137">data</span> is tedious at best and impracticable at worst, which is why working with representative data is so important. If the data you have is very inconsistent, you may need to go back to the source to clean it prior to being able to use the Power Query Editor.</p><p class="Para" id="Par128">Once you create a step to filter out rows, I would <em class="EmphasisTypeItalic ">strongly recommend renaming and documenting</em> that step (see earlier).</p></section>
</section>
<section class="Section1 RenderAsSection1" id="Sec25"><h2 class="Heading">For Future Reference: Future-Proofing Your Work</h2><div class="Para" id="Par129">If only data would stay the same. If only users would never remove or add columns to an Excel <span id="ITerm138">worksheet</span><span id="ITerm139"></span>. We often don’t have much control on the data we work with; therefore, we should never assume that there won’t be any changes. Here are just a <em class="EmphasisTypeItalic ">few</em> of the types of changes that can occur:<div class="OrderedList"><ol><li class="ListItem"><div class="ItemNumber">1.</div><div class="ItemContent"><p class="Para" id="Par130">Columns are renamed, added, or deleted.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">2.</div><div class="ItemContent"><p class="Para" id="Par131">Files are moved, added, or deleted.</p></div><div class="ClearBoth"> </div></li></ol></div></div><p class="Para" id="Par132">When you are working with a database, the data is probably much more stable. But if your data source is Excel, you have a higher likelihood of having columns changed. You need to build your transformation script such that if a change happens, your script can handle it without breaking. This is called <span id="ITerm140">future-proofing</span><span id="ITerm141"></span>. The first step is to make sure your <span id="ITerm142"><span class="EmphasisFontCategoryNonProportional ">Formula Bar</span></span> is visible and <em class="EmphasisTypeItalic ">read the M for every step you create</em>.</p><section class="Section2 RenderAsSection2" id="Sec26"><h3 class="Heading">Excluding and Including Columns</h3><div class="Para" id="Par133">When removing multiple <span id="ITerm143">columns</span>, depending on how you make your selection (as a <span class="EmphasisFontCategoryNonProportional ">Remove Columns</span>, <span class="EmphasisFontCategoryNonProportional ">Remove Other Columns</span>, <span class="EmphasisFontCategoryNonProportional ">Select Columns</span>), the M will be constructed differently. In Figure <span class="InternalRef"><a href="#Fig49">4-49</a></span> a column will be removed. In Figure <span class="InternalRef"><a href="#Fig50">4-50</a></span> only explicitly named columns will be kept.<figure class="Figure" id="Fig49"><div class="MediaObject" id="MO49"><img alt="" aria-describedby="d64e2921" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig49_HTML.jpg" style="width:41.5em" width="1660" height="147"/><div class="TextObject" id="d64e2921"><p class="Para" id="Par225">A line of code reads, = Table dot remove columns, left parenthesis, hashtag, double quotes, split column by delimiter double quotes comma left curly bracket, double quotes, vendor number, double quotes, right curly bracket, right parenthesis.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-49</span><p class="SimplePara">This step will remove a column called “<span id="ITerm144">Vendor Number</span>”</p></div></figcaption></figure><figure class="Figure" id="Fig50"><div class="MediaObject" id="MO50"><img alt="" aria-describedby="d64e2933" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig50_HTML.jpg" style="width:41.48em" width="1659" height="135"/><div class="TextObject" id="d64e2933"><p class="Para" id="Par226">A line of code reads, = Table dot select columns, left parenthesis, hashtag, double quotes, removed columns, double quotes comma left curly bracket, double quotes, vendor name, double quotes, comma, double quotes comment text dot 1, double quotes, comma, double quotes comment text dot 2, double quotes, right curly bracket, right parenthesis.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-50</span><p class="SimplePara">This step will only keep the explicitly named columns</p></div></figcaption></figure></div><p class="Para" id="Par134">In Figure <span class="InternalRef"><a href="#Fig49">4-49</a></span>, one column has been <em class="EmphasisTypeItalic ">excluded</em> explicitly by using <span class="EmphasisFontCategoryNonProportional ">Remove Columns</span>. What happens if the next time the data is refreshed another column is added? Will the new column appear in the report? In this example, the answer is yes because it has not been specifically excluded.</p><p class="Para" id="Par135">In Figure <span class="InternalRef"><a href="#Fig50">4-50</a></span>, three columns have been specifically <em class="EmphasisTypeItalic ">included</em> using <span class="EmphasisFontCategoryNonProportional ">Select Columns</span>. What happens if the next time the data is refreshed another column has been added to the data source? Will the new column appear in the report? The answer is, no, it will <em class="EmphasisTypeItalic ">not</em> because it has not been specifically included.</p><p class="Para" id="Par136">There are many techniques to write M so that it is flexible and can handle changes to the source data, almost all of which are beyond the scope of this book. But there are several good books that have been published in which you learn how to future-proof your queries, which I will list at the end of the chapter. For the PL-300, learn to recognize an M <span id="ITerm145">expression</span> that will break your query or perform unexpectedly. For real life, invest some time in learning how to future-proof your queries—your future self, and colleagues, will thank you.</p></section>
</section>
<section class="Section1 RenderAsSection1" id="Sec27"><h2 class="Heading">Resolving Errors in Your Query</h2><div class="Para" id="Par137">When you see the dreaded yellow error symbol in a query, it can be a little alarming (Figure <span class="InternalRef"><a href="#Fig51">4-51</a></span>)!<figure class="Figure" id="Fig51"><div class="MediaObject" id="MO51"><img alt="" aria-describedby="d64e2996" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig51_HTML.jpg" style="width:21.75em" width="870" height="764"/><div class="TextObject" id="d64e2996"><p class="Para" id="Par227">A screenshot of the query list. Seven queries out of 8 have the warning icon that indicates the presence of errors.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-51</span><p class="SimplePara">A lot of <span id="ITerm146">alarming errors</span>!</p></div></figcaption></figure></div><p class="Para" id="Par138">Hopefully you won’t often see this many errors, but the resolution process is always the same. Start with the step that has the error and then select each step preceding the one with the error, until you find a step that <em class="EmphasisTypeItalic ">isn’t</em> broken. Then identify what happened between the last working step and the first broken step.</p><p class="Para" id="Par139">The good news is that most errors are one of two types: a <span id="ITerm147">broken file path</span> or a prior step in the wrong sequence. I covered broken file paths in the previous chapter, so here I will talk about a few common <em class="EmphasisTypeItalic ">types</em> of steps that break other steps. (I can’t cover every possible error type.)</p><section class="Section2 RenderAsSection2" id="Sec28"><h3 class="Heading">Incorrect Data Type</h3><p class="Para" id="Par140">Usually, you set your data <span id="ITerm148">types</span> as your last step in the query because the <span class="EmphasisFontCategoryNonProportional ">Changed Type</span> step will break <span class="EmphasisFontCategoryNonProportional ">query folding</span> (see earlier). However, there are times when you need to perform an operation on a column or columns. If the existing data types are not compatible with that operation (e.g., you try to multiply two text columns), you may produce an error. The <span id="ITerm149">solution</span> in this case is to insert a <span class="EmphasisFontCategoryNonProportional ">Changed Type</span> step <em class="EmphasisTypeItalic ">before</em> the operational step.</p></section>
<section class="Section2 RenderAsSection2" id="Sec29"><h3 class="Heading">Missing or Renamed Column</h3><div class="Para" id="Par141">If you rename or delete a <span id="ITerm150">column</span> that a subsequent step depends on, the Power Query Editor will generate an error. In Figure <span class="InternalRef"><a href="#Fig52">4-52</a></span>, I have engineered an error by renaming a column in the <span class="EmphasisFontCategoryNonProportional ">Renamed Columns</span> step that then breaks the <span class="EmphasisFontCategoryNonProportional ">Added Custom</span> step (and all following steps).<figure class="Figure" id="Fig52"><div class="MediaObject" id="MO52"><img alt="" aria-describedby="d64e3095" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig52_HTML.png" style="width:42.8em" width="1712" height="455"/><div class="TextObject" id="d64e3095"><p class="Para" id="Par228">A screenshot of an error message for a renamed column. The renamed column option in the query settings was used to rename a column. The file could not be found in the subsequent added custom step.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-52</span><p class="SimplePara">I renamed a <span id="ITerm151">column</span> too early!</p></div></figcaption></figure></div><p class="Para" id="Par142">No matter the type of <span id="ITerm152">error</span>, to troubleshoot I start at the broken step and then look at each step above it in turn. In this case, I would find that the <span class="EmphasisFontCategoryNonProportional ">Renamed Columns</span> step caused the problem, and I can fix the error by deleting that step. Sometimes you must do more radical surgery and rearrange or redo your steps.</p></section>
</section>
<section class="Section1 RenderAsSection1" id="Sec30"><h2 class="Heading">For Future Reference: Reusing Your Work</h2><p class="Para" id="Par143">A well-written <span id="ITerm153">M script</span> can be a work of art. That may seem an extravagant statement, until you spend a considerable amount of time building one! A lot of thought goes into choosing the correct steps, in the right order, preferably without breaking <span class="EmphasisFontCategoryNonProportional ">query folding</span> (see earlier), and planning for future changes to the data. It is nice to know you can reuse your work.</p><section class="Section2 RenderAsSection2" id="Sec31"><h3 class="Heading">The Advanced Editor</h3><div class="Para" id="Par144">The <span id="ITerm154"><span class="EmphasisFontCategoryNonProportional ">Formula Bar</span></span> reflects the M that has been generated for the step currently selected. If you want to see <em class="EmphasisTypeItalic ">all</em> the M that has been generated for a particular query, you need to open the <span class="EmphasisFontCategoryNonProportional ">Advanced Editor</span> on the <span class="EmphasisFontCategoryNonProportional ">Home</span> tab, shown in Figure <span class="InternalRef"><a href="#Fig53">4-53</a></span>.<figure class="Figure" id="Fig53"><div class="MediaObject" id="MO53"><img alt="" aria-describedby="d64e3174" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig53_HTML.png" style="width:35.4em" width="1416" height="1139"/><div class="TextObject" id="d64e3174"><p class="Para" id="Par229">A screenshot of the advanced editor window. The screen displays 14 M statements. A message at the bottom confirms there are no syntax errors. The done and cancel buttons are on the bottom right.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-53</span><p class="SimplePara">The M for a query, in the <span id="ITerm155">Advanced Editor</span><span id="ITerm156"></span></p></div></figcaption></figure></div><p class="Para" id="Par145">While using the <span id="ITerm157"><span class="EmphasisFontCategoryNonProportional ">Advanced Editor</span></span><span id="ITerm158"></span> is beyond the scope of the exam, I want you to know what it can do for you. If you need to modify several steps and you feel confident in your M coding skills, you can edit the M directly in the <span class="EmphasisFontCategoryNonProportional ">Advanced Editor</span>. Additionally, M steps that you see in the <span class="EmphasisFontCategoryNonProportional ">Advanced Editor</span> can be copied as plain text and pasted into another query.</p><div class="Para" id="Par146">When you first start editing M in the <span id="ITerm159"><span class="EmphasisFontCategoryNonProportional ">Advanced Editor</span></span><span id="ITerm160"></span>, there are some common pitfalls:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par147">Make sure that you have a comma after each step <em class="EmphasisTypeItalic ">except</em> the last one (the one just above the <span class="EmphasisFontCategoryNonProportional ">in</span> statement).</p></li><li><p class="Para" id="Par148">Make sure that your M script starts with a <span class="EmphasisFontCategoryNonProportional ">let</span> statement and ends with an <span class="EmphasisFontCategoryNonProportional ">in</span> statement (unless you are using functions).</p></li><li><p class="Para" id="Par149">The <span class="EmphasisFontCategoryNonProportional ">in</span> statement usually references the last step name.</p></li><li><p class="Para" id="Par150">The <span class="EmphasisFontCategoryNonProportional ">Source</span> step (the first one) <em class="EmphasisTypeItalic ">must</em> point to the right location for <em class="EmphasisTypeItalic ">your</em> data source.</p></li><li><p class="Para" id="Par151">When copying and reusing M in another query, check anything that is “hard-coded” (in double quotes) to ensure that an item with that name is present in the destination query.</p></li><li><p class="Para" id="Par152">When <span id="ITerm161">copying</span><span id="ITerm162"></span> and reusing M in another query, check all the step references to ensure that they are present in the new query.</p></li></ul></div></div></section>
<section class="Section2 RenderAsSection2" id="Sec32"><h3 class="Heading">Copying a Query</h3><p class="Para" id="Par153">An even easier way to reuse the <span id="ITerm163">M script</span> is to copy the <span id="ITerm164">query</span> on the <span class="EmphasisFontCategoryNonProportional ">Queries</span> panel. Select the query on the <span class="EmphasisFontCategoryNonProportional ">Queries</span> panel (on the left side of the PQE) and then <span class="EmphasisFontCategoryNonProportional ">Ctrl+C</span>. Open the PQE window for another PBIX file and <span class="EmphasisFontCategoryNonProportional ">Ctrl+V</span>. The entire query is now available to the second PBIX file.</p></section>
<section class="Section2 RenderAsSection2" id="Sec33"><h3 class="Heading">Copying Parts of an M Script</h3><div class="Para" id="Par154">In the <span id="ITerm165"><span class="EmphasisFontCategoryNonProportional ">Formula Bar</span></span><span id="ITerm166"></span><span id="ITerm167"></span>, you can see the M for each step. In the <span class="EmphasisFontCategoryNonProportional ">Advanced Editor</span>, you can see the entire script. You can edit the M here (and in the <span class="EmphasisFontCategoryNonProportional ">Formula Bar</span>), but it might be easier to copy the script and drop it into a text editor. (I use plain-old Notepad.) You can copy elements of the script (shown in Figure <span class="InternalRef"><a href="#Fig54">4-54</a></span>) and then paste those elements into the <span id="ITerm168"><span class="EmphasisFontCategoryNonProportional ">Advanced Editor</span></span> for a different query in which you want to reuse the M.<figure class="Figure" id="Fig54"><div class="MediaObject" id="MO54"><img alt="" aria-describedby="d64e3372" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig54_HTML.png" style="width:35.4em" width="1416" height="1139"/><div class="TextObject" id="d64e3372"><p class="Para" id="Par230">A screenshot of the advanced editor window. The screen displays 14 M statements. The highlighted statements from 7 to 14 can be copied and pasted into the advanced editor window for another query.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-54</span><p class="SimplePara">Sample of an M <span id="ITerm169">script</span><span id="ITerm170"></span> to be copied into another query</p></div></figcaption></figure></div><div class="Para" id="Par155">Like all surgery, be careful when you do this. Here are some common “gotchas”:<div class="OrderedList"><ol><li class="ListItem"><div class="ItemNumber">1.</div><div class="ItemContent"><p class="Para" id="Par156">Step <span id="ITerm171">names</span> are not the same in the two queries.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">2.</div><div class="ItemContent"><p class="Para" id="Par157">Column names are not the same in the two queries.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">3.</div><div class="ItemContent"><p class="Para" id="Par158">The source reference is different (this is usually in the top step).</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">4.</div><div class="ItemContent"><p class="Para" id="Par159">Omitting the comma at the end of a step.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">5.</div><div class="ItemContent"><p class="Para" id="Par160">Including the comma in the last step.</p></div><div class="ClearBoth"> </div></li></ol></div></div><p class="Para" id="Par161">Take your time and pay <span id="ITerm172">attention</span><span id="ITerm173"></span> to the details. <em class="EmphasisTypeItalic ">Don’t try to edit in a hurry; that is the fastest way to break your M script.</em></p></section>
</section>
<section class="Section1 RenderAsSection1" id="Sec34"><h2 class="Heading">Loading Your Queries (or Not)</h2><p class="Para" id="Par162">Once you have completed your work, it is time to <span id="ITerm174">load</span> your changes into the data model. It is important to understand exactly what is happening when you do this. The first thing that will happen is that the script, as it is written, is applied to the full set of the data that <em class="EmphasisTypeItalic ">you have included</em>. Sometimes, though, you don’t want to load a particular query. Perhaps it is a “helper” query. A good example of a “helper” query is one that you appended into another query (as in the example earlier in this chapter). In this scenario, you don’t need the original query as you have already appended (or merged) it into another query.</p><div class="Para" id="Par163">To disable the load of a query, right-click the name of the query and uncheck the box next to <span class="EmphasisFontCategoryNonProportional ">Enable Load</span> as shown in Figure <span class="InternalRef"><a href="#Fig55">4-55</a></span>. This does <em class="EmphasisTypeItalic ">not</em> delete the query. The query name will be indicated in italics once you disable it. The “helper” queries will remain visible in the Power Query <span id="ITerm175">Editor</span> but will <em class="EmphasisTypeItalic ">not</em> appear in the Power BI Desktop.<figure class="Figure" id="Fig55"><div class="MediaObject" id="MO55"><img alt="" aria-describedby="d64e3485" src="../images/532800_1_En_4_Chapter/532800_1_En_4_Fig55_HTML.jpg" style="width:26.58em" width="1063" height="1097"/><div class="TextObject" id="d64e3485"><p class="Para" id="Par231">A screenshot of the query loading options. A query is right-clicked to open a popup menu. The enable load option is unchecked to disable the loading of the query which is now indicated in italics.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 4-55</span><p class="SimplePara">Disable loading to the <span id="ITerm176">Desktop</span></p></div></figcaption></figure></div></section>
<section class="Section1 RenderAsSection1" id="Sec35"><h2 class="Heading">A Few Tips and Tricks</h2><div class="Para" id="Par164">Here are a few <span id="ITerm177">tips and tricks</span> that I hope you take from this chapter. Not all of these are covered on the PL-300 exam, but they will all serve you well:<div class="OrderedList"><ol><li class="ListItem"><div class="ItemNumber">1.</div><div class="ItemContent"><p class="Para" id="Par165">Document your queries and steps.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">2.</div><div class="ItemContent"><p class="Para" id="Par166">Keep like steps together.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">3.</div><div class="ItemContent"><p class="Para" id="Par167">Name your steps.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">4.</div><div class="ItemContent"><p class="Para" id="Par168">Data types matter—be intentional in selecting them.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">5.</div><div class="ItemContent"><p class="Para" id="Par169">Keep the Formula Bar open and read the M for each step.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">6.</div><div class="ItemContent"><p class="Para" id="Par170">Future-proof your queries to the best of your current ability.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">7.</div><div class="ItemContent"><p class="Para" id="Par171">Reuse your M script as/when appropriate.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">8.</div><div class="ItemContent"><p class="Para" id="Par172">Change data <span id="ITerm178">types</span> as close to the last step as you can.</p></div><div class="ClearBoth"> </div></li></ol></div></div></section>
<section class="Section1 RenderAsSection1" id="Sec36"><h2 class="Heading">Additional Resources</h2><div class="Para" id="Par173">It is impossible to cover everything about the Power Query <span id="ITerm179">Editor</span> in a single chapter. With that in mind, I want to recommend a few books that can further your knowledge.<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par174"><em class="EmphasisTypeItalic ">Collect, Combine, and Transform Data Using Power Query in Excel and Power BI</em> by Gil Raviv</p></li><li><p class="Para" id="Par175"><em class="EmphasisTypeItalic ">Master Your Data with Excel and Power BI</em> by Ken Puls and Miguel Escobar</p></li></ul></div></div><p class="Para" id="Par176">In Chapter <span class="ExternalRef"><a href="532800_1_En_15_Chapter.xhtml"><span class="RefSource">15</span></a></span>, I will provide <span id="ITerm180">additional resources</span>, including YouTube and other Internet resources.</p></section>
</div></div></div>
</div>
</body>
</html>