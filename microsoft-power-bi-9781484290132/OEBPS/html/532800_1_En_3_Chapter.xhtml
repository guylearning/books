<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xml:lang="en"
lang="en"
xmlns="http://www.w3.org/1999/xhtml"
xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<title>Microsoft Power BI Data Analyst Certification Companion: Preparation for Exam PL-300</title>
<link rel="stylesheet" type="text/css" href="../override_v1.css"/>
<link rel="stylesheet" type="text/css" href="../css/springer_epub.css"/>
</head>
<body>
<div id="book-content">
<div id="sbo-rt-content"><div epub:type="chapter" role="doc-chapter"><div class="ChapterContextInformation"><div class="ContextInformation" id="b978-1-4842-9013-2_3"><div class="ChapterCopyright">© The Author(s), under exclusive license to APress Media, LLC, part of Springer Nature 2023</div><span class="ContextInformationAuthorEditorNames">J. Jolly</span><span class="ContextInformationBookTitles"><span class="BookTitle">Microsoft Power BI Data Analyst Certification Companion</span></span><span class="ContextInformationSeries"><span class="SeriesTitle" lang="en">Certification Study Companion Series</span></span><span class="ChapterDOI"><a href="https://doi.org/10.1007/978-1-4842-9013-2_3">https://doi.org/10.1007/978-1-4842-9013-2_3</a></span></div></div><!--Begin Abstract--><div class="MainTitleSection"><h1 class="ChapterTitle" lang="en">3. Get Data from Different Sources</h1></div><div class="AuthorGroup"><div class="AuthorNames"><span class="Author"><span class="AuthorName">Jessica Jolly</span><sup><a href="#Aff11">1</a> <span class="ContactIcon"> </span></sup></span></div><div class="Affiliations"><div class="Affiliation" id="Aff11"><span class="AffiliationNumber">(1)</span><div class="AffiliationText">Evanston, IL, USA</div></div><div class="ClearBoth"> </div></div></div><!--End Abstract--><div class="Fulltext"><div class="Para" id="Par2">Power BI can connect to many different <span id="ITerm1">data sources</span>. These connection options are called connectors. Take the time to review all the connectors available; you probably will not encounter a question on the PL-300 about an obscure connector, but you <em class="EmphasisTypeItalic ">should</em> know the commonly used <span id="ITerm2">connectors</span>:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par3">SQL Server (all the flavors)</p></li><li><p class="Para" id="Par4">Excel/CSV</p></li><li><p class="Para" id="Par5">Folders (SharePoint and File Explorer)</p></li><li><p class="Para" id="Par6">Power Platform</p></li><li><p class="Para" id="Par7">Azure</p></li><li><p class="Para" id="Par8">Power BI dataflows and datasets</p></li></ul></div></div><section class="Section1 RenderAsSection1" id="Sec1"><h2 class="Heading">Getting the Data</h2><div class="Para" id="Par9">It is usual to initiate <span id="ITerm3">data extraction</span> after launching the <span id="ITerm4">Power BI Desktop</span> if you are starting a new report. The <span class="EmphasisFontCategoryNonProportional ">Home</span> <span id="ITerm5">tab</span> has multiple options for getting data, as shown in Figure <span class="InternalRef"><a href="#Fig1">3-1</a></span>.<figure class="Figure" id="Fig1"><div class="MediaObject" id="MO1"><img alt="" aria-describedby="d64e395" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig1_HTML.jpg" style="width:42.82em" width="1713" height="638"/><div class="TextObject" id="d64e395"><p class="Para" id="Par82">A screenshot of the power B I toolbar. The home tab is selected and options under the data section are. Get data, excel workbook, data hub, S Q L server, enter data, data verse, and recent sources.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-1</span><p class="SimplePara">The <span id="ITerm6">Home tab</span> has several options for extracting data</p></div></figcaption></figure></div><div class="Para" id="Par10">After initiating the extraction, you will be presented with the <span class="EmphasisFontCategoryNonProportional ">Navigator</span> dialogue <span id="ITerm7">box</span>, as shown in Figure <span class="InternalRef"><a href="#Fig2">3-2</a></span>. This dialogue box is where you can make further selections in your data source. For example, if you are connecting to an Excel workbook, you will see a list of worksheets and table objects in that workbook, as shown in Figure <span class="InternalRef"><a href="#Fig2">3-2</a></span>.<figure class="Figure" id="Fig2"><div class="MediaObject" id="MO2"><img alt="" aria-describedby="d64e431" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig2_HTML.png" style="width:43em" width="1720" height="1374"/><div class="TextObject" id="d64e431"><p class="Para" id="Par83">A screenshot of the navigator dialog box. The left panel has a dropdown with the name of an excel workbook. 3 worksheets under it are selected. The right screen has the data from the product worksheet. The load button at the bottom is highlighted with the transform data button next to it.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-2</span><p class="SimplePara">Selecting worksheets in the <span id="ITerm8">Navigator dialogue box</span></p></div></figcaption></figure></div><p class="Para" id="Par11">As shown in Figure <span class="InternalRef"><a href="#Fig2">3-2</a></span>, it is tempting to choose the <span class="EmphasisFontCategoryNonProportional ">Load</span> button (because it looks like you should). But unless your data is clean and ready to work with, choose <span id="ITerm9"><span class="EmphasisFontCategoryNonProportional ">Transform Data</span></span> instead because it will open the Power Query <span id="ITerm10">Editor</span> window.</p><div class="FormalPara FormalParaRenderingStyle1 ParaTypeImportant" id="FPar1"><div class="Heading">Tip</div><p class="Para FirstParaInFormalPara" id="Par12">In the <span class="EmphasisFontCategoryNonProportional ">Navigator</span> window, you will see three yellow dots that scroll across the top of the window. Do not be misled—they are <em class="EmphasisTypeItalic ">not</em> indicative that you must complete another step.</p></div></section>
<section class="Section1 RenderAsSection1" id="Sec2"><h2 class="Heading">Entering Your Credentials</h2><p class="Para" id="Par13">When you connect to a data source, you may be asked to enter the appropriate <span id="ITerm11">credentials</span>. Each type of connector will require a different type of credential, and some, such as CSV and Excel sources, do not require credentials. For example, if you are connecting to a SQL database, you may have to use a <span id="ITerm12">Windows credential</span> or a <span id="ITerm13">database credential</span>. As a practitioner, you do need to know what type of credentials you should use. In preparation for the exam, it is important for you to understand how and when you will need to change or update <span id="ITerm14">credentials</span>. We will cover that later in this chapter.</p></section>
<section class="Section1 RenderAsSection1" id="Sec3"><h2 class="Heading">Change Data Source Settings</h2><div class="Para" id="Par14">When you bring data into the Power Query <span id="ITerm15">Editor</span>, the query retains the metadata of the file path. The <span class="EmphasisFontCategoryNonProportional ">Source</span> step in the <span class="EmphasisFontCategoryNonProportional ">Applied Steps</span> is the step where you can see the source information. If you need to change the pathway for the source, you can do so in the <span class="EmphasisFontCategoryNonProportional ">Data source settings</span> menu. Figure <span class="InternalRef"><a href="#Fig3">3-3</a></span> shows how to <span id="ITerm16">access</span> the <span class="EmphasisFontCategoryNonProportional ">Data source settings</span> dialogue box.<figure class="Figure" id="Fig3"><div class="MediaObject" id="MO3"><img alt="" aria-describedby="d64e542" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig3_HTML.png" style="width:40.65em" width="1626" height="1132"/><div class="TextObject" id="d64e542"><p class="Para" id="Par84">A screenshot of the power query editor window with the data source settings dialog box. Under the data sources in the current file, there are 2 file locations. The change source button on the bottom is indicated and the close button is highlighted.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-3</span><p class="SimplePara"><span id="ITerm17">Accessing</span> the Data source settings in the Power Query <span id="ITerm18">Editor</span></p></div></figcaption></figure></div><section class="Section2 RenderAsSection2" id="Sec4"><h3 class="Heading">Changing Data Source Settings</h3><p class="Para" id="Par15">It is quite common to need to change the file <span id="ITerm19">path</span> for a particular file. For example, if a colleague shares a PBIX file with you, any files that were used in the PBIX file will have the pathway pointing to where your colleague stored the files. You will have an error until you change the pathway to point to the location on your device. The easiest way to do this is in the <span class="EmphasisFontCategoryNonProportional ">Data source settings</span> dialogue box. But you can also correct the pathway directly from the error screen itself.</p></section>
<section class="Section2 RenderAsSection2" id="Sec5"><h3 class="Heading">When a Data Source Moves</h3><div class="Para" id="Par16">If you have moved a source file’s location, the path that is stored will not resolve. In Figure <span class="InternalRef"><a href="#Fig4">3-4</a></span>, you can see an example of a broken file path.<figure class="Figure" id="Fig4"><div class="MediaObject" id="MO4"><img alt="" aria-describedby="d64e585" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig4_HTML.png" style="width:42.85em" width="1714" height="305"/><div class="TextObject" id="d64e585"><p class="Para" id="Par85">A screenshot of an error message in the power query editor reads. Data source error. Could not find a part of the path. The file path is given. The go-to error button is on the right.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-4</span><p class="SimplePara">A <span id="ITerm20">broken file path</span></p></div></figcaption></figure></div><div class="Para" id="Par17">To change the pathway, you can use the <span class="EmphasisFontCategoryNonProportional ">Go To Error</span> button, which selects the <span class="EmphasisFontCategoryNonProportional ">Source</span> step and offers you an <span class="EmphasisFontCategoryNonProportional ">Edit Settings</span> option, which you can see in Figure <span class="InternalRef"><a href="#Fig5">3-5</a></span>.<figure class="Figure" id="Fig5"><div class="MediaObject" id="MO5"><img alt="" aria-describedby="d64e618" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig5_HTML.png" style="width:42.8em" width="1712" height="343"/><div class="TextObject" id="d64e618"><p class="Para" id="Par86">A screenshot of an error message in the power query editor reads. Data source error. Could not find a part of the path. The file path is given. The edit settings button is on the right. The query settings panel on the right has properties and applied steps sections.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-5</span><p class="SimplePara"><span id="ITerm21">Edit Settings within an error</span></p></div></figcaption></figure></div><div class="Para" id="Par18">You will then be presented with a dialogue box, as shown in Figure <span class="InternalRef"><a href="#Fig6">3-6</a></span>.<figure class="Figure" id="Fig6"><div class="MediaObject" id="MO6"><img alt="" aria-describedby="d64e643" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig6_HTML.jpg" style="width:42.82em" width="1713" height="599"/><div class="TextObject" id="d64e643"><p class="Para" id="Par87">A screenshot of the excel workbook dialog box. The radio button basic is selected and the file path textbox has the file location with a browse button next to it. The ok button below is highlighted.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-6</span><p class="SimplePara">Browse to change the file <span id="ITerm22">path</span></p></div></figcaption></figure></div><p class="Para" id="Par19">This is one of the most common errors you can incur in the Power Query <span id="ITerm23">Editor</span>. In Chapter <span class="ExternalRef"><a href="532800_1_En_4_Chapter.xhtml"><span class="RefSource">4</span></a></span>, we will cover errors in more depth.</p></section>
<section class="Section2 RenderAsSection2" id="Sec6"><h3 class="Heading">Editing Permissions</h3><div class="Para" id="Par20">If you are connecting to a data source such as SQL <span id="ITerm24">Server</span><span id="ITerm25"></span>, you will have to enter the credentials that enable you to access that source. If you need to change these credentials (e.g., your password changes), you can do so in the <span class="EmphasisFontCategoryNonProportional ">Data source settings</span> ➤ <span class="EmphasisFontCategoryNonProportional ">Edit Permissions</span> dialogue box, as shown in Figure <span class="InternalRef"><a href="#Fig7">3-7</a></span>.<figure class="Figure" id="Fig7"><div class="MediaObject" id="MO7"><img alt="" aria-describedby="d64e702" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig7_HTML.jpg" style="width:42.78em" width="1711" height="754"/><div class="TextObject" id="d64e702"><p class="Para" id="Par88">A screenshot of the data source setting dialog box. Under data sources in current file, the demo source is selected. The edit permissions button below is selected. The close button at the bottom is highlighted.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-7</span><p class="SimplePara">Editing permissions on a file <span id="ITerm26">source</span><span id="ITerm27"></span></p></div></figcaption></figure></div><div class="Para" id="Par21">Once you have identified the source you want to change, choose <span class="EmphasisFontCategoryNonProportional ">Edit Permissions</span>, as shown in Figure <span class="InternalRef"><a href="#Fig8">3-8</a></span>.<figure class="Figure" id="Fig8"><div class="MediaObject" id="MO8"><img alt="" aria-describedby="d64e732" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig8_HTML.jpg" style="width:31em" width="1240" height="1581"/><div class="TextObject" id="d64e732"><p class="Para" id="Par89">A screenshot of the edit permissions dialog box for the demo source. The credentials type is windows. The encryption box is unchecked. The privacy level is none. No native database queries are approved. The ok button below is highlighted.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-8</span><p class="SimplePara">The Edit Permissions dialogue <span id="ITerm28">box</span><span id="ITerm29"></span></p></div></figcaption></figure></div><div class="Para" id="Par22">Finally, you arrive at the dialogue box shown in Figure <span class="InternalRef"><a href="#Fig9">3-9</a></span>, where you can choose between three types of credentials: Windows, database, and Microsoft.<figure class="Figure" id="Fig9"><div class="MediaObject" id="MO9"><img alt="" aria-describedby="d64e755" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig9_HTML.jpg" style="width:41.48em" width="1659" height="753"/><div class="TextObject" id="d64e755"><p class="Para" id="Par90">A screenshot of the S Q L server dialog box. The 3 options on the left are windows, database, and Microsoft account. Under windows, the demo server has the use my current credentials option selected. Use alternate credentials option has a username and password textboxes. The save button below is highlighted.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-9</span><p class="SimplePara">Changing your login credentials for a <span id="ITerm30">database</span></p></div></figcaption></figure></div><p class="Para" id="Par23">The type of <span id="ITerm31">credentials</span><span id="ITerm32"></span> you will need depends on how the database administrator has set up your account.</p></section>
<section class="Section2 RenderAsSection2" id="Sec7"><h3 class="Heading">Clear Permissions</h3><p class="Para" id="Par24">If you need to remove and/or replace existing <span id="ITerm33">permissions</span> that you used to connect to a data source, follow the same process as editing permissions. (See Figure <span class="InternalRef"><a href="#Fig7">3-7</a></span>.)</p></section>
<section class="Section2 RenderAsSection2" id="Sec8"><h3 class="Heading">Privacy Levels</h3><div class="Para" id="Par25">To control the potential leakage of your data, you can control the privacy levels of the data in the Power Query <span id="ITerm34">Editor</span><span id="ITerm35"></span><span id="ITerm36"></span>. If you are only working with data from within your organization, you probably don’t need to worry about setting the privacy levels for your data. However, it is important to understand what the options are both for the PL-300 and if you need to use them in your practice:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par26"><em class="EmphasisTypeItalic ">None</em>: There are no privacy restrictions on this data source. It can be combined with other data without any restrictions.</p></li><li><p class="Para" id="Par27"><em class="EmphasisTypeItalic ">Public</em>: This data can be combined with other public or organizational data <span id="ITerm37">sources</span>, and the data is visible to anyone. However, only files, Internet data sources, and workbooks can be marked as public.</p></li><li><p class="Para" id="Par28"><em class="EmphasisTypeItalic ">Organizational</em>: If you mark a data <span id="ITerm38">source</span> as organizational, that data source can be combined with other data sources classified as “organizational.”</p></li><li><p class="Para" id="Par29"><em class="EmphasisTypeItalic ">Private</em>: A data <span id="ITerm39">source</span> classified as private will isolate that data completely. It cannot be combined with any other data source, even other data sources classified as private.</p></li></ul></div></div><div class="Para" id="Par30">You can access the <span class="EmphasisFontCategoryNonProportional ">Privacy Level</span><span id="ITerm40"></span><span id="ITerm41"></span> in the <span class="EmphasisFontCategoryNonProportional ">Edit Permissions</span> dialogue box as shown in Figure <span class="InternalRef"><a href="#Fig10">3-10</a></span>.<figure class="Figure" id="Fig10"><div class="MediaObject" id="MO10"><img alt="" aria-describedby="d64e877" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig10_HTML.jpg" style="width:25.1em" width="1004" height="1259"/><div class="TextObject" id="d64e877"><p class="Para" id="Par91">A screenshot of the edit permissions dialog box. The privacy level dropdown is selected with 4 options under it. None, public, organizational, and private. The ok button at the bottom is highlighted.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-10</span><p class="SimplePara">The Privacy <span id="ITerm42">Level</span><span id="ITerm43"></span></p></div></figcaption></figure></div><p class="Para" id="Par31">The challenge with setting <span id="ITerm44">privacy levels</span><span id="ITerm45"></span> is that you can set them too rigorously. If you do so, you can incur a <span class="EmphasisFontCategoryNonProportional ">Formula.Firewall</span> error in your query. Another concern with privacy levels is that they can slow down a refresh once your report is published in the Service. There is an option to disable the privacy levels in the <span class="EmphasisFontCategoryNonProportional ">File</span> ➤ <span class="EmphasisFontCategoryNonProportional ">Options and settings</span> ➤ <span class="EmphasisFontCategoryNonProportional ">Options</span> ➤ <span class="EmphasisFontCategoryNonProportional ">Global</span> ➤ <span class="EmphasisFontCategoryNonProportional ">Privacy</span> menu. If you do choose to disable the <span class="EmphasisFontCategoryNonProportional ">privacy</span> levels, you must be sure that you are only working with data within your organization’s control.</p></section>
</section>
<section class="Section1 RenderAsSection1" id="Sec9"><h2 class="Heading">Selecting a Storage Mode</h2><p class="Para" id="Par32">In addition to entering credentials, you will also need to determine a storage mode (if applicable) for the data source. For sources like <span id="ITerm46">SQL Server</span><span id="ITerm47"></span>, you will be presented with two options: <span class="EmphasisFontCategoryNonProportional ">Import</span> or <span class="EmphasisFontCategoryNonProportional ">Direct Query</span>. Knowing the differences (and limitations) of these modes is included in the <span id="ITerm48">PL-300 exam</span>.</p><section class="Section2 RenderAsSection2" id="Sec10"><h3 class="Heading">Import</h3><p class="Para" id="Par33">The default storage mode is <span class="EmphasisFontCategoryNonProportional ">Import</span><span id="ITerm49"></span><span id="ITerm50"></span>. In this mode, Power BI extracts a copy of the selected tables (or views) and stores them in the Analysis Services database that is spun up when you create a PBIX file. <span class="EmphasisFontCategoryNonProportional ">Import</span> does <em class="EmphasisTypeItalic ">not</em> affect the source of the data—you are not “writing back” to the source in any way. <em class="EmphasisTypeItalic ">Import is a copy</em> of the data at the time of extraction. Contrary to your initial assumption, you do <em class="EmphasisTypeItalic ">not</em> need to work with a constantly refreshed copy of the data to build your report. If the data that you are working with is <em class="EmphasisTypeItalic ">representative</em> of the latest data, that is sufficient.</p><p class="Para" id="Par34">What does it mean for data to be representative? It does <em class="EmphasisTypeItalic ">not</em> mean that the values are the same or the most recent. It means that the structure of the data remains consistent as data is added, updated, or deleted.</p><p class="Para" id="Par35">Using the <span class="EmphasisFontCategoryNonProportional ">Import</span> <span id="ITerm51">mode</span><span id="ITerm52"></span> is a much more efficient way to process your queries: your report will be more responsive. You will also have full control over the data model—you can add measures, create the tables you need, and structure relationships optimally.</p></section>
<section class="Section2 RenderAsSection2" id="Sec11"><h3 class="Heading">Direct Query</h3><p class="Para" id="Par36">When I teach a class on Power BI and <span id="ITerm53"><span class="EmphasisFontCategoryNonProportional ">Direct Query</span></span><span id="ITerm54"></span> comes up, invariably a student says, “You should always use Direct Query so you can have the latest data.” Not to put too fine a point on it, this is not necessary. It <em class="EmphasisTypeItalic ">is</em> true that if you use <span class="EmphasisFontCategoryNonProportional ">Direct Query</span> you will always be using the latest data. But you will pay a performance price for that timeliness. And you don’t usually need to work with the most recent data. If the data you are working with is representative (see earlier) of all the data, working with older data is not an issue.</p><p class="Para" id="Par37"><span id="ITerm55"><span class="EmphasisFontCategoryNonProportional ">Direct Query</span></span><span id="ITerm56"></span> creates a connection between the Power BI Desktop and the data source. Your report’s responsiveness will be dependent on the latency of this connection, something that is probably not in your control but can negatively affect your report performance. You will not be able to perform any transformations or modeling of the data—you must use the data as is. If the data has been fully prepped for all your reporting requirements, this restriction may not be an issue. But you need to be sure that it meets your needs. Using <span class="EmphasisFontCategoryNonProportional ">Direct Query</span> can also have a negative impact on the server that you are connecting to; be sure to talk to the database and/or server owner to make sure that your report doesn’t create an inordinate burden.</p><div class="Para" id="Par38">Before you choose <span id="ITerm57"><span class="EmphasisFontCategoryNonProportional ">Direct Query</span></span><span id="ITerm58"></span> as your storage mode, fully investigate whether the data really needs to be up-to-the-minute. Here are some questions you can ask yourself or your report consumers:<div class="OrderedList"><ol><li class="ListItem"><div class="ItemNumber">1.</div><div class="ItemContent"><p class="Para" id="Par39">How often will the report consumers act on the data? If the data is only actioned once a day, or even twice a day, you don’t need <span class="EmphasisFontCategoryNonProportional ">Direct Query</span>.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">2.</div><div class="ItemContent"><p class="Para" id="Par40">Do you have a lot of historical data in your dataset? If you have data that is several years old, typically you do not need the data from five minutes ago, because you are making decisions across a wider time frame.</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">3.</div><div class="ItemContent"><p class="Para" id="Par41">Does the data change significantly in real time? How often is the data refreshed at the source?</p></div><div class="ClearBoth"> </div></li><li class="ListItem"><div class="ItemNumber">4.</div><div class="ItemContent"><p class="Para" id="Par42">Are parts of the source data refreshed at different rates? If yes, you don’t want to use <span class="EmphasisFontCategoryNonProportional ">Direct Query</span> because parts of your report could conflict.</p></div><div class="ClearBoth"> </div></li></ol></div></div><p class="Para" id="Par43">Don’t choose <span id="ITerm59"><span class="EmphasisFontCategoryNonProportional ">Direct Query</span></span><span id="ITerm60"></span> unless you have some overriding business justification for it; the disadvantages often outweigh any advantages.</p></section>
<section class="Section2 RenderAsSection2" id="Sec12"><h3 class="Heading">For Future Reference: Writing Your Own SQL Code</h3><p class="Para" id="Par44">In the same dialogue <span id="ITerm61">box</span> where you see the <span class="EmphasisFontCategoryNonProportional ">Import</span> and <span class="EmphasisFontCategoryNonProportional ">Direct Query</span> options, you will also see an <span class="EmphasisFontCategoryNonProportional ">Advanced</span> drop-down. This is where you <em class="EmphasisTypeItalic ">could</em> write your own SQL to extract exactly what you need from the source. Writing your own SQL statement immediately breaks “query folding” (explained in Chapter <span class="ExternalRef"><a href="532800_1_En_4_Chapter.xhtml"><span class="RefSource">4</span></a></span>), which is a bad thing. If you choose to write a custom SQL query, do so only if you are confident that you can write a better query than Power Query can generate.</p></section>
<section class="Section2 RenderAsSection2" id="Sec13"><h3 class="Heading">Live Connection</h3><p class="Para" id="Par45">When you connect to an <span id="ITerm62">Analysis Services source</span>, it is called a <span id="ITerm63"><span class="EmphasisFontCategoryNonProportional ">Live Connection</span></span><span id="ITerm64"></span>. These three sources are SQL Server Analysis Services Tabular, SQL Server Analysis Services Multidimensional, and Power BI Service dataset.</p><div class="FormalPara FormalParaRenderingStyle1 ParaTypeImportant" id="FPar2"><div class="Heading">Note on Hybrid Tables</div><p class="Para FirstParaInFormalPara" id="Par46">In December 2021, Microsoft announced the ability to combine data that has been imported and data that is accessed via <span id="ITerm65">Direct Query</span>. These are called hybrid tables and are accomplished by partitioning the data. The primary benefit of a hybrid table is you get the speedy performance of imported data and the latest data via Direct Query. Partitions are not covered in the PL-300 exam and are beyond the scope of this book, but I want you to know what is meant by hybrid tables.</p></div></section>
</section>
<section class="Section1 RenderAsSection1" id="Sec14"><h2 class="Heading">Using Different Data Sources</h2><div class="Para" id="Par47">The likelihood is that you will be connecting to data sources that are used heavily in your organization: your <span id="ITerm66">ERP system</span><span id="ITerm67"></span> (finance, accounts payable/receivable, inventory) and your <span id="ITerm68">CRM system</span><span id="ITerm69"></span> (customers, sales pipelines, marketing) are the most prevalent. You can browse the list of connectors under the <span class="EmphasisFontCategoryNonProportional ">Get data</span> <span id="ITerm70">menu</span> to find the right connector as shown in Figure <span class="InternalRef"><a href="#Fig11">3-11</a></span>.<figure class="Figure" id="Fig11"><div class="MediaObject" id="MO11"><img alt="" aria-describedby="d64e1227" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig11_HTML.jpg" style="width:42.82em" width="1713" height="1543"/><div class="TextObject" id="d64e1227"><p class="Para" id="Par92">A screenshot of the power B I window. Under the home tab, the get data icon is selected and 10 common data sources are listed in a dropdown. The more button at the end of the list is highlighted.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-11</span><p class="SimplePara">Reviewing all the connectors <span id="ITerm71">available</span></p></div></figcaption></figure></div><p class="Para" id="Par48">And of course, there are always good old Excel and CSV files. But there is a whole new world of data sources that you have (potentially) available to you. (Whether you have them available to you or not, you need to know <em class="EmphasisTypeItalic ">about</em> them for the exam.)</p><section class="Section2 RenderAsSection2" id="Sec15"><h3 class="Heading">Dataverse</h3><p class="Para" id="Par49"><span id="ITerm72">Dataverse</span><span id="ITerm73"></span> is the new name for what used to be called the “<span id="ITerm74">Common Data Service</span>.” Approximately five years ago (don’t quote me on the exact date), Microsoft realized that within their Dynamics CRM tool, they were sitting on a gold mine: a ready-made database infrastructure that could be used by non-database-literate folks (like me) to build a database. There are premade tables in Dataverse for commonly used data structures, such as accounts, contacts, and so on. It’s a database in a box. And even better, Dataverse is part of the Open Data Initiative, something that Microsoft, SAP, and Adobe have collaborated to create. You can also use Dataverse to build your own tables, if you can’t find one that works for you in the premade ones.</p><p class="Para" id="Par50"><span id="ITerm75">Dataverse</span><span id="ITerm76"></span> is the data infrastructure that underpins the entire Power Platform, so it should not be a surprise that Power BI can connect to a Dataverse model. Dataverse tables are housed in something called an <span id="ITerm77"><span class="EmphasisFontCategoryNonProportional ">environment</span></span>, and you need to have the URL to connect to an instance of it. That URL will usually contain some reference to “CRM” and/or “Dynamics.” (Remember, Dataverse emerged from Dynamics CRM.)</p></section>
<section class="Section2 RenderAsSection2" id="Sec16"><h3 class="Heading">Dataflows</h3><p class="Para" id="Par51">A <span id="ITerm78">dataflow</span><span id="ITerm79"></span> is a set of data on which someone has performed transformations and saved that work.</p><p class="Para" id="Par52">Imagine you have a colleague who is quite skilled with the Power Query <span id="ITerm80">Editor</span>. This person could perform transformations on a variety of data and then share the completed work as a dataflow. Another use case: Often multiple report creators have the need to connect to the same underlying data source, but for some reason, they should not connect directly to the data source. A dataflow can be created that provides the content (tables, views) that the report creators need.</p><div class="Para" id="Par53">To use a <span id="ITerm81">dataflow</span><span id="ITerm82"></span>, you will need to have permissions for it (which we cover in a later chapter). Once you have the appropriate permissions, connecting to a dataflow is not substantively different from connecting from any other data source, as shown in Figure <span class="InternalRef"><a href="#Fig12">3-12</a></span>.<figure class="Figure" id="Fig12"><div class="MediaObject" id="MO12"><img alt="" aria-describedby="d64e1328" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig12_HTML.jpg" style="width:32.48em" width="1299" height="1638"/><div class="TextObject" id="d64e1328"><p class="Para" id="Par93">A screenshot of the navigator dialog box. The power B I dataflows drop-down is expanded and under the training workspace, there are 4 folders. The north wind data folder is selected and 8 dataflows are listed within.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-12</span><p class="SimplePara">Connecting to a <span id="ITerm83">dataflow</span><span id="ITerm84"></span> in a workspace</p></div></figcaption></figure></div></section>
<section class="Section2 RenderAsSection2" id="Sec17"><h3 class="Heading">Shared Dataset</h3><p class="Para" id="Par54">If someone in your organization has already put a lot of work into creating a dataset, anyone who has <span id="ITerm85">permissions</span> to that dataset can use it to create a new report. We will talk further in a later chapter about datasets, but the benefit of using a shared dataset is the time savings. Someone else can do all the work of transforming and modeling the data, and you can use it all in a report. Just a side note: Using a <span id="ITerm86">shared dataset</span> creates a <span class="EmphasisFontCategoryNonProportional ">Live Connection</span> (see earlier).</p></section>
<section class="Section2 RenderAsSection2" id="Sec18"><h3 class="Heading">Local Dataset</h3><p class="Para" id="Par55">A <span id="ITerm87">local dataset</span><span id="ITerm88"></span> is one sitting on your computer. There isn’t anything unusual about connecting to a local dataset <em class="EmphasisTypeItalic ">except</em> when you try to set up the refresh schedule for the local dataset in the Power BI Service. The Service will not be able to “reach” this dataset without a gateway, which will be covered in a later chapter.</p></section>
<section class="Section2 RenderAsSection2" id="Sec19"><h3 class="Heading">Using Folders and SharePoint Folders</h3><div class="Para" id="Par56">When you first use the Power Query <span id="ITerm89">Editor</span><span id="ITerm90"></span>, you could be forgiven if you think that you connect to each source, one by one. And, in fact, for some sources, you do have to perform this action in sequence. But if a source can be put into a folder (on a shared drive, on your laptop, on SharePoint), you can connect to the folder. What you will be extracting is <em class="EmphasisTypeItalic ">a list</em> of what is in the folder (the metadata) as shown in Figure <span class="InternalRef"><a href="#Fig13">3-13</a></span>.<figure class="Figure" id="Fig13"><div class="MediaObject" id="MO13"><img alt="" aria-describedby="d64e1401" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig13_HTML.jpg" style="width:42.82em" width="1713" height="421"/><div class="TextObject" id="d64e1401"><p class="Para" id="Par94">A screenshot of the power query editor window. A table has 4 columns content, name, extension, and date accessed. The content column has the folder name. The name column has the names of files inside the corresponding folder. The extension has value x l s x.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-13</span><p class="SimplePara">The contents of a folder as a query</p></div></figcaption></figure></div><div class="Para" id="Par57">That list will be your <span id="ITerm91">query</span><span id="ITerm92"></span>. There is a hyperlink where you can expand the actual dataset for each item in the list. If your organization puts files that are related to one another in the same folder (e.g., monthly budget Excel workbooks), connecting to the folder is far more efficient than connecting to each workbook singly. You can also combine the individual files together as a single query, as shown in Figure <span class="InternalRef"><a href="#Fig14">3-14</a></span>.<figure class="Figure" id="Fig14"><div class="MediaObject" id="MO14"><img alt="" aria-describedby="d64e1428" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig14_HTML.png" style="width:42.85em" width="1714" height="552"/><div class="TextObject" id="d64e1428"><p class="Para" id="Par95">A screenshot of the power query editor window. A table has 7 columns content, name, extension, date accessed, date modified, date created, and attributes. The combine and transform button below is highlighted. The transform data button is next to it.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-14</span><p class="SimplePara">Options for combining files</p></div></figcaption></figure></div><div class="FormalPara FormalParaRenderingStyle1 ParaTypeImportant" id="FPar3"><div class="Heading">Tip</div><p class="Para FirstParaInFormalPara" id="Par58">You usually combine files that have the same structure: number of columns, names of columns. If you combine queries with different structures, there may be a lot of “messy” transformations to perform.</p></div><p class="Para" id="Par59"><span id="ITerm93">SharePoint folders</span><span id="ITerm94"></span> work the same way, but there is one trick: you need the <em class="EmphasisTypeItalic ">top-level</em> URL to the SharePoint. Nothing else will work.</p></section>
</section>
<section class="Section1 RenderAsSection1" id="Sec20"><h2 class="Heading">Parameters</h2><div class="Para" id="Par60">A parameter is one of the terms that stumped me when I began to learn <span id="ITerm95">Power BI</span>. I understood a parameter as a boundary or a limit. But within Power BI, it follows another definition: an arbitrary constant or an independent variable. (All three definitions courtesy of Merriam-Webster Dictionary.) A parameter does one of three things within Power BI:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par61">Provides a value to a function within the Power Query <span id="ITerm96">Editor</span></p></li><li><p class="Para" id="Par62">Allows a user to enter a value in the Power BI Desktop</p></li><li><p class="Para" id="Par63">Allows a user to enter a value in the Power BI Service</p></li></ul></div></div><p class="Para" id="Par64">For the <span id="ITerm97">PL-300 exam</span>, you will be expected to know how to change the value of a parameter, but I want you to understand what a parameter is, where you create them, and <em class="EmphasisTypeItalic ">some</em> of the ways you can use them.</p><div class="FormalPara FormalParaRenderingStyle1 ParaTypeImportant" id="FPar4"><div class="Heading">Tip</div><p class="Para FirstParaInFormalPara" id="Par65">This is one of the few features where I do show how to create/use it because parameters can be a little confusing when you are first getting started.</p></div><section class="Section2 RenderAsSection2" id="Sec21"><h3 class="Heading">Defining Parameters</h3><p class="Para" id="Par66">All parameters need to be defined in the Power Query <span id="ITerm98">Editor</span>; they are part of data preparation. To <span id="ITerm99">define</span> a parameter, follow this list of steps:</p><p class="Para" id="Par67"><em class="EmphasisTypeItalic ">Step 1</em>: Select <span class="EmphasisFontCategoryNonProportional ">Manage Parameters</span>.</p><p class="Para" id="Par68"><em class="EmphasisTypeItalic ">Step 2</em>: Select <span class="EmphasisFontCategoryNonProportional ">New Parameter</span>.</p><div class="Para" id="Par69"><em class="EmphasisTypeItalic ">Step 3</em>: Populate the <span class="EmphasisFontCategoryNonProportional ">New Parameter</span> dialogue box as shown in Figure <span class="InternalRef"><a href="#Fig15">3-15</a></span>.<figure class="Figure" id="Fig15"><div class="MediaObject" id="MO15"><img alt="" aria-describedby="d64e1549" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig15_HTML.jpg" style="width:37.57em" width="1503" height="1012"/><div class="TextObject" id="d64e1549"><p class="Para" id="Par96">A screenshot of the manage parameters dialog box. The panel on the left has a list of parameters with the new button on top. The screen on the right has name, description, and current value textboxes with type and suggested values dropdown boxes. The required check box is checked.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-15</span><p class="SimplePara">The <span id="ITerm100">New Parameter dialogue box</span></p></div></figcaption></figure></div><p class="Para" id="Par70"><em class="EmphasisTypeItalic ">Step 4</em>: Provide a name and a description for your parameter. Use a name that is unique.</p><p class="Para" id="Par71"><em class="EmphasisTypeItalic ">Step 5</em>: Specify the data <span id="ITerm101">type</span> for the value that will be supplied to the parameter (e.g., if you are going to enter dates, specify the <span class="EmphasisFontCategoryNonProportional ">Date</span> data type).</p><div class="Para" id="Par72"><em class="EmphasisTypeItalic ">Step 6</em>: If there is only going to be a restricted list of possible values, you can provide these values in a list you create or use an existing query that has all the values already in it. If you want to use an existing column in an existing query, select that column, right-click, and choose <span class="EmphasisFontCategoryNonProportional ">Add as a new query</span>. This will create a new query that is a list (a single column) that you can then provide as an input to the parameter as shown in Figure <span class="InternalRef"><a href="#Fig16">3-16</a></span>.<figure class="Figure" id="Fig16"><div class="MediaObject" id="MO16"><img alt="" aria-describedby="d64e1595" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig16_HTML.jpg" style="width:37.25em" width="1490" height="1173"/><div class="TextObject" id="d64e1595"><p class="Para" id="Par97">A screenshot of the manage parameters dialog box. Sample parameter is selected. Type is any. Suggested values has the query option selected. Query has the country zip option selected. Current value reads select a country zip combination.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-16</span><p class="SimplePara">Populating the Manage Parameters dialogue <span id="ITerm102">box</span></p></div></figcaption></figure></div><p class="Para" id="Par73"><em class="EmphasisTypeItalic ">Step 7</em>: Provide a default value for the parameter. This will be the value that displays when a user first opens the <span id="ITerm103">parameter</span>. You can enter a helpful message such as “Enter a date here” or choose a default value.</p><div class="FormalPara FormalParaRenderingStyle1 ParaTypeImportant" id="FPar5"><div class="Heading">Tip</div><p class="Para FirstParaInFormalPara" id="Par74">If you have ever used the <span class="EmphasisFontCategoryNonProportional ">Data Validation</span> feature in Excel, this process will be very familiar. The only feature this dialogue box doesn’t offer is the ability to add a message.</p></div></section>
<section class="Section2 RenderAsSection2" id="Sec22"><h3 class="Heading">Within the Power Query Editor</h3><p class="Para" id="Par75">One use case that is very common is to enable users to change file paths easily. Creating this parameter is straightforward.</p><div class="Para" id="Par76">Follow Steps 1–5 as outlined earlier in the section “Defining Parameters.” For Step 6, instead of using an existing query as for <span class="EmphasisFontCategoryNonProportional ">Suggested Values</span>, create a list that will hold the file paths. In Figure <span class="InternalRef"><a href="#Fig17">3-17</a></span>, there are two <span id="ITerm104">file paths</span> shown, but the list can contain only one file path.<figure class="Figure" id="Fig17"><div class="MediaObject" id="MO17"><img alt="" aria-describedby="d64e1653" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig17_HTML.jpg" style="width:35.45em" width="1418" height="1554"/><div class="TextObject" id="d64e1653"><p class="Para" id="Par98">A screenshot of the manage parameters dialog box. The file path parameter is selected. The type is text. Suggested values has the list of values option selected. Default and current values textboxes each have different paths of file location.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-17</span><p class="SimplePara">Setting up a list of <span id="ITerm105">file paths</span> as a parameter</p></div></figcaption></figure></div><div class="Para" id="Par77">Once you set up the list of values, you can then change the parameter value as shown in Figure <span class="InternalRef"><a href="#Fig18">3-18</a></span>.<figure class="Figure" id="Fig18"><div class="MediaObject" id="MO18"><img alt="" aria-describedby="d64e1679" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig18_HTML.jpg" style="width:42.82em" width="1713" height="544"/><div class="TextObject" id="d64e1679"><p class="Para" id="Par99">A screenshot of the power query editor window. In the query panel on the left, the file path option is selected. The screen on the right has a current value textbox with the path of the file location. The manage parameters button is below.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-18</span><p class="SimplePara">Changing the parameter value in the Power Query <span id="ITerm106">Editor</span><span id="ITerm107"></span></p></div></figcaption></figure></div></section>
<section class="Section2 RenderAsSection2" id="Sec23"><h3 class="Heading">In the Power BI Desktop</h3><p class="Para" id="Par78">Once you have created a parameter, you can then use it in the <span id="ITerm108">Power BI Desktop</span><span id="ITerm109"></span>. In our file path parameter example, you can make the parameter available as a data source. The first step is loading the parameter to the data model, something that does <em class="EmphasisTypeItalic ">not</em> happen by default. You must <span class="EmphasisFontCategoryNonProportional ">Enable load</span> for the parameter, as shown in Figure <span class="InternalRef"><a href="#Fig19">3-19</a></span>.</p><div class="Para" id="Par79">The other common use for a parameter is to set up a parameter with a server and database name pre-populated. This method is useful because it is not uncommon to need to connect to the same source for different tables or views.<figure class="Figure" id="Fig19"><div class="MediaObject" id="MO19"><img alt="" aria-describedby="d64e1717" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig19_HTML.jpg" style="width:42.82em" width="1713" height="1164"/><div class="TextObject" id="d64e1717"><p class="Para" id="Par100">A screenshot of the power query editor window. In the query panel on the left, the file path option is selected. A right-click drop-down list has the enable load option selected and indicated. The screen on the right has a current value textbox.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-19</span><p class="SimplePara">Enabling the load for the parameter</p></div></figcaption></figure></div><div class="Para" id="Par80">When you have enabled the load, the next time you choose <span class="EmphasisFontCategoryNonProportional ">Apply</span> (or <span class="EmphasisFontCategoryNonProportional ">Close and Apply</span>), the <span id="ITerm110">parameter</span><span id="ITerm111"></span> will appear in your data model in the Power BI Desktop. To access the parameter, navigate to <span class="EmphasisFontCategoryNonProportional ">Transform data</span> ➤ <span id="ITerm112"><span class="EmphasisFontCategoryNonProportional ">Edit parameters</span></span>, and select the appropriate parameter as shown in Figures <span class="InternalRef"><a href="#Fig20">3-20</a></span> and <span class="InternalRef"><a href="#Fig21">3-21</a></span>.<figure class="Figure" id="Fig20"><div class="MediaObject" id="MO20"><img alt="" aria-describedby="d64e1776" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig20_HTML.png" style="width:42.82em" width="1713" height="456"/><div class="TextObject" id="d64e1776"><p class="Para" id="Par101">A screenshot of the power B I window. The toolbar has the home tab selected. The transform data icon is chosen and 3 options are listed. Transform data, data source settings, and edit parameters. The edit parameter option is indicated.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-20</span><p class="SimplePara">Accessing the parameters created in the Power Query <span id="ITerm113">Editor</span><span id="ITerm114"></span></p></div></figcaption></figure><figure class="Figure" id="Fig21"><div class="MediaObject" id="MO21"><img alt="" aria-describedby="d64e1796" src="../images/532800_1_En_3_Chapter/532800_1_En_3_Fig21_HTML.jpg" style="width:42.82em" width="1713" height="494"/><div class="TextObject" id="d64e1796"><p class="Para" id="Par102">A screenshot of the edit parameters dialog box. The file path drop-down list has 2 file locations options. The ok button below is highlighted.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 3-21</span><p class="SimplePara">Choosing the <span id="ITerm115">parameter</span></p></div></figcaption></figure></div><div class="FormalPara FormalParaRenderingStyle1 ParaTypeImportant" id="FPar6"><div class="Heading">Incremental Refresh</div><p class="Para FirstParaInFormalPara" id="Par81">One of the most common uses of parameters is <span id="ITerm116">incremental refresh</span><span id="ITerm117"></span>. The first time you publish your report in the Service (covered in a later chapter), you will set up a refresh schedule. Often, you want to bring in all the data when you first publish and, in subsequent refreshes, only bring in the new or changed data. Incremental refreshes allow you to specify the start date and end date of the data you want to target during the subsequent refreshes. Setting up a <span class="EmphasisFontCategoryNonProportional ">RangeStart</span> and <span class="EmphasisFontCategoryNonProportional ">RangeEnd</span> parameter is a prerequisite for setting up an incremental refresh.</p></div></section>
</section>
</div></div></div>
</div>
</body>
</html>